import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{a as t,c as n,d as r,i,l as a,n as o,o as s,r as c,s as l,t as u}from"./charting-D3UwNZQE.js";import{n as d,t as f}from"./vendor-DA_41aWq.js";import{a as p,c as m,i as h,n as g,o as _,r as v,s as y,t as b}from"./react-vendor-FIhfqODO.js";import{_ as x,a as S,c as C,d as w,f as T,g as E,h as D,i as O,l as k,m as A,n as j,o as M,p as N,r as P,s as F,t as I,u as L,v as R}from"./firebase-BjsNgwjm.js";import{C as z,D as B,E as ee,O as te,S as ne,T as re,_ as V,a as ie,b as H,c as ae,d as oe,f as se,g as ce,h as U,i as le,l as ue,m as de,n as fe,o as W,p as pe,r as me,s as he,t as G,u as ge,v as K,w as _e,x as q,y as J}from"./lucide-icons-DIQzSCMp.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var ve=e(d()),Y=e(r()),ye=R({apiKey:`AIzaSyAGm3bzsCxYSARcgVn41ta_EOut9fauWr0`,authDomain:`ecommerce-74229.firebaseapp.com`,projectId:`ecommerce-74229`,storageBucket:`ecommerce-74229.firebasestorage.app`,messagingSenderId:`47160479095`,appId:`1:47160479095:web:0dd3a844d5d5c3847ea572`,measurementId:`G-47FYXTR59Z`}),X=A(ye),Z=S(ye),Q=e(f()),be=(0,Y.createContext)();const $=()=>(0,Y.useContext)(be),xe=({children:e})=>{let[t,n]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(!0),a=(e,t)=>N(X,e,t),o=(e,t)=>E(X,e,t),s=()=>x(X);(0,Y.useEffect)(()=>D(X,e=>{n(e),i(!1)}),[]);let c={currentUser:t,signup:a,login:o,logout:s};return(0,Q.jsx)(be.Provider,{value:c,children:r?(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-gray-50`,children:(0,Q.jsxs)(`div`,{className:`text-center`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600`,children:`Loading...`})]})}):e})};function Se(){let e=(0,Y.useRef)(),t=(0,Y.useRef)(),{login:n}=$(),r=m(),[i,a]=(0,Y.useState)(``),[o,s]=(0,Y.useState)(!1);return(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4`,children:(0,Q.jsx)(`div`,{className:`w-full max-w-md`,children:(0,Q.jsxs)(`form`,{onSubmit:async i=>{i.preventDefault();try{a(``),s(!0),await n(e.current.value,t.current.value),r(`/dashboard`)}catch{a(`Failed to sign in. Please check your credentials and try again.`)}s(!1)},className:`bg-white p-8 rounded-2xl shadow-lg border border-gray-100`,children:[(0,Q.jsxs)(`div`,{className:`text-center mb-8`,children:[(0,Q.jsx)(`div`,{className:`mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4`,children:(0,Q.jsx)(`span`,{className:`text-white font-bold text-xl`,children:`MB`})}),(0,Q.jsx)(`h2`,{className:`text-2xl font-bold text-gray-900`,children:`Welcome Back`}),(0,Q.jsx)(`p`,{className:`text-gray-600 mt-2`,children:`Sign in to your account`})]}),i&&(0,Q.jsx)(`div`,{className:`bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm`,children:i}),(0,Q.jsxs)(`div`,{className:`mb-4`,children:[(0,Q.jsx)(`label`,{htmlFor:`email`,className:`block text-sm font-medium text-gray-700 mb-1`,children:`Email`}),(0,Q.jsx)(`input`,{type:`email`,id:`email`,ref:e,placeholder:`Enter your email`,required:!0,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]}),(0,Q.jsxs)(`div`,{className:`mb-6`,children:[(0,Q.jsx)(`label`,{htmlFor:`password`,className:`block text-sm font-medium text-gray-700 mb-1`,children:`Password`}),(0,Q.jsx)(`input`,{type:`password`,id:`password`,ref:t,placeholder:`Enter your password`,required:!0,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]}),(0,Q.jsx)(`button`,{disabled:o,className:`w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50`,children:o?`Signing In...`:`Sign In`}),(0,Q.jsxs)(`p`,{className:`mt-6 text-center text-gray-600`,children:[`Don't have an account?`,` `,(0,Q.jsx)(g,{to:`/signup`,className:`text-indigo-600 hover:text-indigo-800 font-medium`,children:`Sign Up`})]})]})})})}function Ce(){let e=(0,Y.useRef)(),t=(0,Y.useRef)(),n=(0,Y.useRef)(),{signup:r}=$(),i=m(),[a,o]=(0,Y.useState)(``),[s,c]=(0,Y.useState)(!1);return(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4`,children:(0,Q.jsx)(`div`,{className:`w-full max-w-md`,children:(0,Q.jsxs)(`form`,{onSubmit:async a=>{if(a.preventDefault(),t.current.value!==n.current.value)return o(`Passwords do not match`);if(t.current.value.length<6)return o(`Password should be at least 6 characters`);try{o(``),c(!0),await r(e.current.value,t.current.value),i(`/dashboard`)}catch{o(`Failed to create an account. Please try again.`)}c(!1)},className:`bg-white p-8 rounded-2xl shadow-lg border border-gray-100`,children:[(0,Q.jsxs)(`div`,{className:`text-center mb-8`,children:[(0,Q.jsx)(`div`,{className:`mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4`,children:(0,Q.jsx)(`span`,{className:`text-white font-bold text-xl`,children:`MB`})}),(0,Q.jsx)(`h2`,{className:`text-2xl font-bold text-gray-900`,children:`Create Account`}),(0,Q.jsx)(`p`,{className:`text-gray-600 mt-2`,children:`Sign up to get started`})]}),a&&(0,Q.jsx)(`div`,{className:`bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm`,children:a}),(0,Q.jsxs)(`div`,{className:`mb-4`,children:[(0,Q.jsx)(`label`,{htmlFor:`email`,className:`block text-sm font-medium text-gray-700 mb-1`,children:`Email`}),(0,Q.jsx)(`input`,{type:`email`,id:`email`,ref:e,placeholder:`Enter your email`,required:!0,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]}),(0,Q.jsxs)(`div`,{className:`mb-4`,children:[(0,Q.jsx)(`label`,{htmlFor:`password`,className:`block text-sm font-medium text-gray-700 mb-1`,children:`Password`}),(0,Q.jsx)(`input`,{type:`password`,id:`password`,ref:t,placeholder:`Create a password`,required:!0,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]}),(0,Q.jsxs)(`div`,{className:`mb-6`,children:[(0,Q.jsx)(`label`,{htmlFor:`confirmPassword`,className:`block text-sm font-medium text-gray-700 mb-1`,children:`Confirm Password`}),(0,Q.jsx)(`input`,{type:`password`,id:`confirmPassword`,ref:n,placeholder:`Confirm your password`,required:!0,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]}),(0,Q.jsx)(`button`,{disabled:s,className:`w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50`,children:s?`Creating Account...`:`Sign Up`}),(0,Q.jsxs)(`p`,{className:`mt-6 text-center text-gray-600`,children:[`Already have an account?`,` `,(0,Q.jsx)(g,{to:`/login`,className:`text-indigo-600 hover:text-indigo-800 font-medium`,children:`Sign In`})]})]})})})}var we=()=>(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h1`,{children:`Create your porfile`}),(0,Q.jsxs)(`form`,{action:``,children:[(0,Q.jsx)(`input`,{type:`text`,placeholder:`Your full name `}),(0,Q.jsx)(`input`,{type:`email`,placeholder:`Your email`,name:``,id:``}),(0,Q.jsx)(`input`,{type:`number`,placeholder:`You phone number `,name:``,id:``}),(0,Q.jsx)(`input`,{type:`number`,placeholder:`You Age  `,name:``,id:``}),(0,Q.jsxs)(`option`,{value:``,children:[(0,Q.jsx)(`select`,{name:`male`,id:``,children:`Male`}),(0,Q.jsx)(`select`,{name:`female`,id:``,children:`Female`})]}),(0,Q.jsx)(`input`,{type:`file`,placeholder:`Upload your photo`}),(0,Q.jsx)(`button`,{type:`submit`,children:`Create account`})]})]})}),Te=()=>{let[e,r]=(0,Y.useState)(0),[d,f]=(0,Y.useState)(0),[p,m]=(0,Y.useState)(0),[h,g]=(0,Y.useState)(0),[_,v]=(0,Y.useState)(!1),[y,b]=(0,Y.useState)(!1),[x,S]=(0,Y.useState)(!1),[w,T]=(0,Y.useState)([]),[E,D]=(0,Y.useState)([]),[O,A]=(0,Y.useState)([]),[M,N]=(0,Y.useState)(!0),P=e=>new Date(e).toLocaleString(`en-US`,{month:`short`,day:`numeric`,hour:`numeric`,hour12:!0});(0,Y.useEffect)(()=>{if(!Z){S(`Firestore instance not available`),N(!1);return}let e=k(j(Z,`users`),C(`createdAt`,`desc`)),t=F(e,e=>{try{let t=e.docs.map(e=>({id:e.id,...e.data()}));A(t),g(t.length),N(!1),S(!1)}catch(e){console.error(`Error processing users snapshot:`,e),S(`Failed to process users data`),N(!1)}},e=>{console.error(`Error fetching users:`,e),e.code===`permission-denied`?S(`Permission denied. Check Firestore rules.`):S(`Failed to load users: `+(e.message||`Unknown error`)),N(!1)});return()=>t()},[]);let I=({active:e,payload:t,label:n})=>{if(e&&t&&t.length){let e=t[0].payload;return(0,Q.jsxs)(`div`,{className:`bg-white p-4 border border-gray-200 shadow-lg rounded-md`,children:[(0,Q.jsx)(`p`,{className:`font-medium text-gray-900`,children:P(e.timestamp)}),(0,Q.jsxs)(`p`,{className:`text-indigo-600`,children:[`Deposits: $`,e.deposits.toFixed(2)]}),(0,Q.jsxs)(`p`,{className:`text-red-600`,children:[`loans: $`,e.loans.toFixed(2)]})]})}return null},L=(e,t,n=20)=>{let r=[];return e.forEach(e=>{let t=e.timestamp?.toDate?.()||new Date(e.timestamp);r.push({timestamp:t,name:t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}),deposits:Number(e.amount)||0,loans:0})}),t.forEach(e=>{let t=e.timestamp?.toDate?.()||new Date(e.timestamp);r.push({timestamp:t,name:t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}),deposits:0,loans:Number(e.amount)||0})}),r.sort((e,t)=>e.timestamp-t.timestamp),r.slice(-n)};(0,Y.useEffect)(()=>{if(!Z){console.error(`Firestore database instance not available`),v(!0),b(!0);return}let e=[],t=[],n=k(j(Z,`deposits`),C(`timestamp`,`desc`)),i=F(n,n=>{try{let i=0;e=[],n.forEach(t=>{let n=t.data();n.amount&&(i+=parseFloat(n.amount)),e.push({id:t.id,...n,timestamp:n.timestamp})}),r(i),v(!1);let a=L(e,t);T(a),D(t=>[...e.slice(0,3).map(e=>({id:e.id,type:`deposit`,userId:e.userId,amount:e.amount,timestamp:e.timestamp?.toDate?.()||new Date})),...t].slice(0,6))}catch(e){console.error(`Error processing deposits data:`,e),v(!0)}},e=>{console.error(`Error fetching deposits:`,e),v(!0)}),a=k(j(Z,`loans`),C(`timestamp`,`desc`)),o=F(a,n=>{try{let r=0,i=0;t=[],n.forEach(e=>{let n=e.data();n.amount&&(r+=parseFloat(n.amount)),n.status===`pending`&&(i+=1),t.push({id:e.id,...n,timestamp:n.timestamp})}),f(r),m(i),b(!1);let a=L(e,t);T(a),D(e=>[...t.slice(0,3).map(e=>({id:e.id,type:`cashout`,userId:e.userId,amount:e.amount,status:e.status,timestamp:e.timestamp?.toDate?.()||new Date})),...e].slice(0,6))}catch(e){console.error(`Error processing loans data:`,e),b(!0)}},e=>{console.error(`Error fetching loans:`,e),b(!0)});return()=>{i(),o()}},[]);let R=e=>`$${e.toFixed(2)}`,z=e=>new Date(e).toLocaleDateString(`en-US`,{month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}),ne=[{id:1,name:`Total Deposits`,value:_?`N/A`:R(e),change:`+12.5%`,changeType:`positive`,icon:V,iconColor:`bg-indigo-500`},{id:2,name:`Total loans`,value:y?`N/A`:R(d),change:`+8.2%`,changeType:`positive`,icon:K,iconColor:`bg-red-500`},{id:3,name:`Pending loans`,value:y?`N/A`:p,change:`+3.1%`,changeType:`negative`,icon:te,iconColor:`bg-yellow-500`},{id:4,name:`Total Users`,value:x?`N/A`:h,change:`+5.4%`,changeType:`positive`,icon:me,iconColor:`bg-green-500`}];return M?(0,Q.jsx)(`div`,{className:`flex items-center justify-center h-96`,children:(0,Q.jsxs)(`div`,{className:`text-center`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600`,children:`Loading dashboard...`})]})}):(0,Q.jsxs)(`div`,{className:`space-y-6`,children:[(0,Q.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6`,children:ne.map(e=>(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 transition-all duration-200 hover:shadow-md`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:e.name}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:e.value})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full ${e.iconColor}`,children:(0,Q.jsx)(e.icon,{className:`h-6 w-6 text-white`})})]}),(0,Q.jsxs)(`div`,{className:`mt-4 flex items-center`,children:[e.changeType===`positive`?(0,Q.jsx)(ee,{className:`h-4 w-4 text-green-500`}):(0,Q.jsx)(B,{className:`h-4 w-4 text-red-500`}),(0,Q.jsx)(`span`,{className:`ml-1 text-sm font-medium ${e.changeType===`positive`?`text-green-500`:`text-red-500`}`,children:e.change}),(0,Q.jsx)(`span`,{className:`ml-2 text-sm text-gray-500`,children:`from last month`})]})]},e.id))}),(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 gap-6`,children:[(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900 mb-4`,children:`Live Transactions`}),(0,Q.jsx)(`div`,{className:`h-80 overflow-x-hidden`,children:(0,Q.jsx)(a,{width:`100%`,height:`100%`,children:(0,Q.jsxs)(u,{data:w,margin:{top:5,right:30,left:20,bottom:5},children:[(0,Q.jsx)(s,{strokeDasharray:`3 3`}),(0,Q.jsx)(i,{dataKey:`name`,tick:{fontSize:10},interval:0,minTickGap:15}),(0,Q.jsx)(c,{}),(0,Q.jsx)(n,{content:(0,Q.jsx)(I,{})}),(0,Q.jsx)(l,{dataKey:`deposits`,fill:`#4f46e5`,name:`Deposits`,isAnimationActive:!0,animationDuration:800,animationEasing:`ease-in-out`}),(0,Q.jsx)(l,{dataKey:`loans`,fill:`#ef4444`,name:`loans`,isAnimationActive:!0,animationDuration:800,animationEasing:`ease-in-out`})]})})})]}),(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900 mb-4`,children:`Transaction Trend`}),(0,Q.jsx)(`div`,{className:`h-80 overflow-x-hidden`,children:(0,Q.jsx)(a,{width:`100%`,height:`100%`,children:(0,Q.jsxs)(o,{data:w,margin:{top:5,right:30,left:20,bottom:5},children:[(0,Q.jsx)(s,{strokeDasharray:`3 3`}),(0,Q.jsx)(i,{dataKey:`name`,tick:{fontSize:10},interval:0,minTickGap:15}),(0,Q.jsx)(c,{}),(0,Q.jsx)(n,{content:(0,Q.jsx)(I,{})}),(0,Q.jsx)(t,{type:`monotone`,dataKey:`deposits`,stroke:`#4f46e5`,activeDot:{r:8},name:`Deposits`,isAnimationActive:!0,animationDuration:800,animationEasing:`ease-in-out`}),(0,Q.jsx)(t,{type:`monotone`,dataKey:`loans`,stroke:`#ef4444`,name:`loans`,isAnimationActive:!0,animationDuration:800,animationEasing:`ease-in-out`})]})})})]})]}),(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center justify-between mb-4`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900`,children:`Recent Activity`}),(0,Q.jsx)(`button`,{className:`text-sm font-medium text-indigo-600 hover:text-indigo-800`,children:`View all`})]}),(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Type`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`User ID`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Amount`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Status`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Date`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:E.length>0?E.map(e=>(0,Q.jsxs)(`tr`,{className:`hover:bg-gray-50 transition-colors duration-150`,children:[(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[e.type===`deposit`?(0,Q.jsx)(`div`,{className:`w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center`,children:(0,Q.jsx)(V,{className:`h-4 w-4 text-indigo-600`})}):(0,Q.jsx)(`div`,{className:`w-8 h-8 rounded-full bg-red-100 flex items-center justify-center`,children:(0,Q.jsx)(K,{className:`h-4 w-4 text-red-600`})}),(0,Q.jsx)(`span`,{className:`ml-3 text-sm font-medium text-gray-900 capitalize`,children:e.type})]})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:e.userId||`N/A`}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900`,children:R(e.amount||0)}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:e.type===`deposit`?(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800`,children:`Completed`}):(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e.status===`Pending`?`bg-yellow-100 text-yellow-800`:e.status===`Accepted`?`bg-green-100 text-green-800`:`bg-red-100 text-red-800`}`,children:e.status||`Pending`})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:z(e.timestamp)})]},e.id)):(0,Q.jsx)(`tr`,{children:(0,Q.jsx)(`td`,{colSpan:`5`,className:`px-6 py-4 text-center text-sm text-gray-500`,children:`No recent activity`})})})]})})]})]})},Ee=()=>{let{currentUser:e}=$(),[t,n]=(0,Y.useState)([]),[r,i]=(0,Y.useState)([]),[a,o]=(0,Y.useState)(!0),[s,c]=(0,Y.useState)(null),[l,u]=(0,Y.useState)(``),[d,f]=(0,Y.useState)(null),[p,m]=(0,Y.useState)(!1),[h,g]=(0,Y.useState)(new Set);(0,Y.useEffect)(()=>{if(!e)return;let t=F(j(Z,`users`),e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t)},e=>{console.error(`Error fetching users:`,e)});return()=>t()},[e]),(0,Y.useEffect)(()=>{if(!e)return;let t=F(j(Z,`loans`),e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),t.sort((e,t)=>{let n=e.paymentTimestamp?.toDate?.()||new Date(0);return(t.paymentTimestamp?.toDate?.()||new Date(0))-n}),n(t),o(!1)},e=>{console.error(`Error fetching paybacks:`,e),o(!1)});return()=>t()},[e]);let _=t.map(e=>{let t=r.find(t=>t.uid===e.userId);return{...e,userName:t?.fullName||`Unknown User`,userEmail:t?.email||`No email provided`}}),v=(e,t)=>{c({message:e,type:t}),setTimeout(()=>{c(null)},3e3)},y=async e=>{try{g(t=>new Set(t).add(e)),setTimeout(async()=>{let t=P(Z,`loans`,e);await T(t,{paymentStatus:`approved`,adminReviewedAt:L()}),setTimeout(()=>{g(t=>{let n=new Set(t);return n.delete(e),n})},300),v(`Payment approved successfully!`,`success`)},100)}catch(t){console.error(`Error approving payment:`,t),v(`Failed to approve payment. Please try again.`,`error`),g(t=>{let n=new Set(t);return n.delete(e),n})}},b=async e=>{try{g(t=>new Set(t).add(e)),setTimeout(async()=>{let t=P(Z,`loans`,e);await T(t,{paymentStatus:`denied`,adminReviewedAt:L()}),setTimeout(()=>{g(t=>{let n=new Set(t);return n.delete(e),n})},300),v(`Payment denied.`,`error`)},100)}catch(t){console.error(`Error denying payment:`,t),v(`Failed to deny payment. Please try again.`,`error`),g(t=>{let n=new Set(t);return n.delete(e),n})}},x=e=>{f(e),m(!0)},S=()=>{m(!1),f(null)},C=e=>{if(!e)return`N/A`;let t=e.toDate(),n=t.getDate().toString().padStart(2,`0`),r=(t.getMonth()+1).toString().padStart(2,`0`),i=t.getFullYear(),a=t.getHours().toString().padStart(2,`0`),o=t.getMinutes().toString().padStart(2,`0`);return`${n}/${r}/${i} ${a}:${o}`},w=_.filter(e=>{if(e.status!==`accepted`)return!1;let t=e.userName||``,n=l.toLowerCase();return t.toLowerCase().includes(n)}),E=_.filter(e=>e.status===`accepted`&&e.paymentStatus===`pending`).length;return(0,Q.jsxs)(`div`,{className:`min-h-screen bg-gray-50 py-8`,children:[s&&(0,Q.jsx)(`div`,{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 ${s.type===`success`?`bg-green-500 text-white`:`bg-red-500 text-white`}`,children:s.message}),(0,Q.jsxs)(`div`,{className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`,children:[(0,Q.jsxs)(`div`,{className:`mb-8`,children:[(0,Q.jsx)(`h1`,{className:`text-3xl font-bold text-gray-900`,children:`Loan Repayment Management`}),(0,Q.jsx)(`p`,{className:`mt-2 text-gray-600`,children:`Review and manage loan repayments for accepted loans`})]}),(0,Q.jsx)(`div`,{className:`bg-white rounded-xl shadow-sm p-6 mb-6`,children:(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`,children:(0,Q.jsx)(W,{className:`h-5 w-5 text-gray-400`})}),(0,Q.jsx)(`input`,{type:`text`,placeholder:`Search by user name...`,value:l,onChange:e=>u(e.target.value),className:`block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`})]})}),(0,Q.jsxs)(`div`,{className:`bg-white rounded-xl shadow-sm p-6`,children:[(0,Q.jsxs)(`div`,{className:`flex justify-between items-center mb-6`,children:[(0,Q.jsx)(`h2`,{className:`text-xl font-semibold text-gray-900`,children:`Accepted Loan Repayments`}),(0,Q.jsxs)(`span`,{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800`,children:[E,` pending`]})]}),a?(0,Q.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-12`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4`}),(0,Q.jsx)(`p`,{className:`text-gray-600`,children:`Loading loan repayments...`})]}):w.length===0?(0,Q.jsxs)(`div`,{className:`text-center py-12`,children:[(0,Q.jsx)(`div`,{className:`mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center mb-4`,children:(0,Q.jsx)(W,{className:`h-8 w-8 text-gray-400`})}),(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900 mb-1`,children:`No accepted loans found`}),(0,Q.jsx)(`p`,{className:`text-gray-500`,children:`There are no accepted loans at the moment.`})]}):(0,Q.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6`,children:w.map(e=>{let t=h.has(e.id),n=!e.paymentStatus||e.paymentStatus===`pending`;return(0,Q.jsx)(`div`,{className:`bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md ${t?`opacity-0 scale-95`:`opacity-100 scale-100`}`,children:(0,Q.jsxs)(`div`,{className:`p-6`,children:[(0,Q.jsxs)(`div`,{className:`flex justify-between items-start mb-4`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[(0,Q.jsx)(`div`,{className:`flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center`,children:(0,Q.jsx)(`span`,{className:`text-indigo-800 font-medium`,children:e.userName?.charAt(0)?.toUpperCase()||`U`})}),(0,Q.jsxs)(`div`,{className:`ml-3`,children:[(0,Q.jsx)(`h3`,{className:`text-sm font-medium text-gray-900`,children:e.userName||`Unknown User`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-500`,children:e.userEmail||`No email provided`})]})]}),(0,Q.jsx)(`span`,{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                            ${e.paymentStatus===`approved`?`bg-green-100 text-green-800`:e.paymentStatus===`denied`?`bg-red-100 text-red-800`:`bg-yellow-100 text-yellow-800`}`,children:e.paymentStatus?.charAt(0)?.toUpperCase()+e.paymentStatus?.slice(1)||`Pending`})]}),(0,Q.jsxs)(`div`,{className:`space-y-3 mb-6`,children:[(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Loan Amount`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,e.amount]})]}),(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Interest (10%)`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,(e.amount*.1).toFixed(2)]})]}),(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Total Payable`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,e.totalPayable?.toFixed(2)||(e.amount*1.1).toFixed(2)]})]}),(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Paid Amount`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,e.paidAmount]})]}),(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Payment Date`}),(0,Q.jsx)(`span`,{className:`text-sm font-medium text-gray-900`,children:C(e.paymentTimestamp)})]}),e.adminReviewedAt&&(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Reviewed At`}),(0,Q.jsx)(`span`,{className:`text-sm font-medium text-gray-900`,children:C(e.adminReviewedAt)})]})]}),(0,Q.jsxs)(`div`,{className:`mb-6`,children:[(0,Q.jsx)(`span`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Proof of Payment`}),e.proofImageUrl?(0,Q.jsxs)(`div`,{className:`relative w-full h-32 rounded-lg overflow-hidden cursor-pointer border border-gray-200`,onClick:()=>x(e.proofImageUrl),children:[(0,Q.jsx)(`img`,{src:e.proofImageUrl,alt:`Proof of payment`,className:`w-full h-full object-cover`}),(0,Q.jsx)(`div`,{className:`absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity`,children:(0,Q.jsx)(U,{className:`h-6 w-6 text-white`})})]}):(0,Q.jsx)(`div`,{className:`w-full h-32 rounded-lg bg-gray-100 flex items-center justify-center border border-gray-200`,children:(0,Q.jsx)(`span`,{className:`text-gray-500 text-sm`,children:`No proof provided`})})]}),(0,Q.jsxs)(`div`,{className:`flex space-x-3`,children:[(0,Q.jsxs)(`button`,{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg transition-colors ${n?`text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500`:`text-gray-400 bg-gray-100 cursor-not-allowed`}`,onClick:()=>y(e.id),disabled:!n,children:[(0,Q.jsx)(ne,{className:`-ml-1 mr-2 h-4 w-4`}),`Approve`]}),(0,Q.jsxs)(`button`,{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border text-sm font-medium rounded-lg transition-colors ${n?`text-gray-700 bg-white border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`:`text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed`}`,onClick:()=>b(e.id),disabled:!n,children:[(0,Q.jsx)(G,{className:`-ml-1 mr-2 h-4 w-4`}),`Deny`]})]})]})},e.id)})})]})]}),p&&(0,Q.jsx)(`div`,{className:`fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4`,onClick:S,children:(0,Q.jsxs)(`div`,{className:`relative max-w-4xl max-h-full`,onClick:e=>e.stopPropagation(),children:[(0,Q.jsx)(`button`,{className:`absolute -top-12 right-0 text-white hover:text-gray-300 focus:outline-none`,onClick:S,children:(0,Q.jsx)(G,{className:`h-8 w-8`})}),(0,Q.jsx)(`img`,{src:d,alt:`Proof of payment`,className:`max-w-full max-h-screen rounded-lg`})]})})]})},De=()=>{let[e,t]=(0,Y.useState)([]),[n,r]=(0,Y.useState)([]),[i,a]=(0,Y.useState)(!0),[o,s]=(0,Y.useState)(null),[c,l]=(0,Y.useState)(``),[u,d]=(0,Y.useState)(`All`),[f,p]=(0,Y.useState)(null),[m,h]=(0,Y.useState)(!1),[g,_]=(0,Y.useState)({});(0,Y.useEffect)(()=>{let e=k(j(Z,`users`)),t=F(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));r(t)},e=>{console.error(`Error loading users:`,e),s(`Failed to load users: `+e.message)});return()=>t()},[]),(0,Y.useEffect)(()=>{let e=k(j(Z,`deposits`),C(`timestamp`,`desc`)),r=F(e,e=>{try{let r=e.docs.map(e=>({id:e.id,...e.data()})).map(e=>{let t=n.find(t=>t.uid===e.userId);return{...e,userName:t?t.fullName||`Unnamed User`:`Unknown User`}});t(r),a(!1)}catch(e){console.error(`Error merging deposit data:`,e),s(`Error processing deposit data: `+e.message),a(!1)}},e=>{console.error(`Firestore error:`,e),s(`Failed to load deposits: `+e.message),a(!1)});return()=>r()},[n]);let v=e=>{switch(e){case`accepted`:return`bg-green-100 text-green-800`;case`denied`:return`bg-red-100 text-red-800`;case`pending`:return`bg-yellow-100 text-yellow-800`;default:return`bg-gray-100 text-gray-800`}},y=async(e,t)=>{try{let n=P(Z,`deposits`,e);await T(n,{status:t}),console.log(`Deposit ${e} status updated to ${t}`)}catch(e){console.error(`Error updating deposit status:`,e),s(`Failed to update deposit status: `+e.message)}},b=e=>{if(!e)return`N/A`;if(e.seconds){let t=new Date(e.seconds*1e3);return t.toLocaleDateString()+` `+t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})}if(e.toDate){let t=e.toDate();return t.toLocaleDateString()+` `+t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})}return e.toString()},x=e.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),S=e.filter(e=>e.status===`pending`).length,w=e.filter(e=>e.status===`accepted`).length,E=e.filter(e=>e.status===`denied`).length,D=e.filter(e=>e.status===`accepted`).reduce((e,t)=>e+(parseFloat(t.amount)||0),0),O=e.filter(e=>e.status===`denied`).reduce((e,t)=>e+(parseFloat(t.amount)||0),0),A=e.filter(e=>{let t=e.userName?.toLowerCase().includes(c.toLowerCase())||e.userId?.toLowerCase().includes(c.toLowerCase())||e.message?.toLowerCase().includes(c.toLowerCase()),n=u===`All`||e.status===u;return t&&n}),M=e=>{p(e),h(!0)},N=()=>{h(!1),p(null)};return i?(0,Q.jsx)(`div`,{className:`flex items-center justify-center h-96`,children:(0,Q.jsxs)(`div`,{className:`text-center`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600`,children:`Loading deposits...`})]})}):o?(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 text-center`,children:[(0,Q.jsxs)(`p`,{className:`text-red-500`,children:[`Error: `,o]}),(0,Q.jsx)(`button`,{onClick:()=>window.location.reload(),className:`mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200`,children:`Retry`})]}):(console.log(`DepositsPage: Rendering with deposits array length:`,e.length),(0,Q.jsxs)(`div`,{className:`space-y-6`,children:[(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`,children:[(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Deposits`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,x.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-indigo-100`,children:(0,Q.jsx)(V,{className:`h-6 w-6 text-indigo-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Pending Deposits`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:S})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-yellow-100`,children:(0,Q.jsx)(J,{className:`h-6 w-6 text-yellow-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Approved Deposits`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:w})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-green-100`,children:(0,Q.jsx)(q,{className:`h-6 w-6 text-green-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Denied Deposits`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:E})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-red-100`,children:(0,Q.jsx)(H,{className:`h-6 w-6 text-red-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Accepted Amount`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,D.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-green-100`,children:(0,Q.jsx)(q,{className:`h-6 w-6 text-green-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Declined Amount`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,O.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-red-100`,children:(0,Q.jsx)(H,{className:`h-6 w-6 text-red-600`})})]})})]}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0`,children:[(0,Q.jsx)(`h2`,{className:`text-lg font-medium text-gray-900`,children:`Deposit Records`}),(0,Q.jsxs)(`div`,{className:`flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`,children:(0,Q.jsx)(W,{className:`h-5 w-5 text-gray-400`})}),(0,Q.jsx)(`input`,{type:`text`,placeholder:`Search by name, user ID or message...`,className:`block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`,value:c,onChange:e=>l(e.target.value)})]}),(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsxs)(`select`,{className:`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50`,value:u,onChange:e=>d(e.target.value),children:[(0,Q.jsx)(`option`,{value:`All`,children:`All Statuses`}),(0,Q.jsx)(`option`,{value:`pending`,children:`Pending`}),(0,Q.jsx)(`option`,{value:`accepted`,children:`Accepted`}),(0,Q.jsx)(`option`,{value:`denied`,children:`Denied`})]}),(0,Q.jsx)(`div`,{className:`absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none`,children:(0,Q.jsx)(pe,{className:`h-5 w-5 text-gray-400`})})]})]})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`User Name`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Amount`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Status`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Proof`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Date`}),(0,Q.jsx)(`th`,{scope:`col`,className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Actions`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:A.length>0?A.map(e=>(0,Q.jsxs)(`tr`,{className:`hover:bg-gray-50 transition-colors duration-150`,children:[(0,Q.jsxs)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:[(0,Q.jsx)(`div`,{className:`text-sm font-medium text-gray-900`,children:e.userName}),(0,Q.jsxs)(`div`,{className:`text-xs text-gray-500 italic`,children:[`ID: `,e.userId]})]}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsxs)(`div`,{className:`text-sm font-semibold text-gray-900`,children:[`$`,e.amount?parseFloat(e.amount).toFixed(2):`0.00`]})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(e.status||`pending`)}`,children:e.status||`pending`})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:e.imageUrl?(0,Q.jsxs)(`button`,{onClick:()=>M(e),className:`text-indigo-600 hover:text-indigo-900 flex items-center`,children:[(0,Q.jsx)(U,{className:`h-4 w-4 mr-1`}),`View`]}):(0,Q.jsx)(`span`,{className:`text-gray-400`,children:`No proof`})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:b(e.timestamp)}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm font-medium`,children:(0,Q.jsxs)(`div`,{className:`flex items-center space-x-3`,children:[e.status===`pending`?(0,Q.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,Q.jsx)(`button`,{disabled:!!g[e.id],onClick:async()=>{if(window.confirm(`Mark this deposit as Accepted?`)){_(t=>({...t,[e.id]:!0}));try{await y(e.id,`accepted`),console.log(`Deposit accepted:`,e.id)}finally{_(t=>{let n={...t};return delete n[e.id],n})}}},className:`px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200 disabled:opacity-50`,children:g[e.id]?`Processing...`:`Approve`}),(0,Q.jsx)(`button`,{disabled:!!g[e.id],onClick:async()=>{if(window.confirm(`Mark this deposit as Denied?`)){_(t=>({...t,[e.id]:!0}));try{await y(e.id,`denied`),console.log(`Deposit denied:`,e.id)}finally{_(t=>{let n={...t};return delete n[e.id],n})}}},className:`px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50`,children:g[e.id]?`Processing...`:`Deny`})]}):(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:e.status||`No actions`}),e.imageUrl?(0,Q.jsx)(`button`,{onClick:()=>window.open(e.imageUrl,`_blank`),className:`text-indigo-600 hover:text-indigo-900 flex items-center`,title:`View proof in new tab`,children:(0,Q.jsx)(ce,{className:`h-4 w-4`})}):null]})})]},e.id)):(0,Q.jsx)(`tr`,{children:(0,Q.jsx)(`td`,{colSpan:`6`,className:`px-6 py-4 text-center text-sm text-gray-500`,children:`No deposits found.`})})})]})})}),m&&f&&(0,Q.jsx)(`div`,{className:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4`,children:(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden`,children:[(0,Q.jsxs)(`div`,{className:`p-6 border-b border-gray-200 flex justify-between items-center`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900`,children:`Deposit Proof`}),(0,Q.jsx)(`button`,{onClick:N,className:`text-gray-400 hover:text-gray-500`,children:(0,Q.jsx)(H,{className:`h-6 w-6`})})]}),(0,Q.jsxs)(`div`,{className:`p-6`,children:[(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`User Name`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:f.userName||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`User ID`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:f.userId||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`Amount`}),(0,Q.jsxs)(`p`,{className:`text-sm text-gray-900`,children:[`$`,f.amount?parseFloat(f.amount).toFixed(2):`0.00`]})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`Status`}),(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(f.status||`pending`)}`,children:f.status||`pending`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`Date`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:b(f.timestamp)})]}),(0,Q.jsxs)(`div`,{className:`md:col-span-2`,children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-1`,children:`Message`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:f.message||`No message`})]})]}),(0,Q.jsxs)(`div`,{className:`mt-6`,children:[(0,Q.jsx)(`h4`,{className:`text-sm font-medium text-gray-500 mb-2`,children:`Proof Image`}),(0,Q.jsx)(`div`,{className:`border border-gray-200 rounded-lg overflow-hidden`,children:f.imageUrl?(0,Q.jsx)(`img`,{src:f.imageUrl,alt:`Deposit Proof`,className:`w-full h-auto max-h-[60vh] object-contain`,onError:e=>{e.target.style.display=`none`}}):(0,Q.jsx)(`div`,{className:`flex items-center justify-center h-64 bg-gray-100 text-gray-500`,children:`No image available`})})]}),(0,Q.jsxs)(`div`,{className:`mt-6 flex justify-end space-x-3`,children:[(0,Q.jsx)(`button`,{onClick:N,className:`px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50`,children:`Close`}),f.status===`pending`&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(`button`,{onClick:()=>{y(f.id,`accepted`),N()},className:`px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700`,children:`Approve`}),(0,Q.jsx)(`button`,{onClick:()=>{y(f.id,`denied`),N()},className:`px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700`,children:`Deny`})]})]})]})]})})]}))};function Oe(){let{currentUser:e}=$(),[t,n]=(0,Y.useState)([]),[r,i]=(0,Y.useState)(``),[a,o]=(0,Y.useState)(!0),[s,c]=(0,Y.useState)(new Set),[l,u]=(0,Y.useState)({}),d=(0,Y.useRef)(),f=(0,Y.useRef)();(0,Y.useEffect)(()=>{if(!e)return;(async()=>{try{let t=P(Z,`users`,e.uid);await T(t,{isOnline:!0,lastActive:L()})}catch(e){console.error(`Error setting user online:`,e)}})(),f.current=setInterval(async()=>{try{let t=P(Z,`users`,e.uid);await T(t,{lastActive:L()})}catch(e){console.error(`Error updating lastActive:`,e)}},3e4);let t=async()=>{try{let t=P(Z,`users`,e.uid);await T(t,{isOnline:!1,lastActive:L()})}catch(e){console.error(`Error setting user offline:`,e)}};return window.addEventListener(`beforeunload`,t),()=>{clearInterval(f.current),window.removeEventListener(`beforeunload`,t),e&&(async()=>{try{let t=P(Z,`users`,e.uid);await T(t,{isOnline:!1,lastActive:L()})}catch(e){console.error(`Error setting user offline:`,e)}})()}},[e]),(0,Y.useEffect)(()=>{if(!e){o(!1);return}let t=k(j(Z,`messages`),C(`timestamp`,`asc`));return F(t,e=>{n(e.docs.map(e=>({id:e.id,...e.data()}))),o(!1)})},[e]),(0,Y.useEffect)(()=>{if(e)return F(j(Z,`users`),e=>{let t={},n=new Set;e.forEach(e=>{let r=e.data();if(t[e.id]=r,r.isOnline&&r.lastActive){let t=r.lastActive.toDate();(new Date-t)/(1e3*60)<2?n.add(e.id):T(e(Z,`users`,e.id),{isOnline:!1})}}),u(t),c(n)})},[e]);let p=async t=>{if(t.preventDefault(),!(!e||!r.trim()))try{await I(j(Z,`messages`),{text:r,userId:e.uid,userName:e.email?e.email.split(`@`)[0]:`Anonymous`,timestamp:L()}),i(``)}catch(e){console.error(`Error sending message:`,e)}};(0,Y.useEffect)(()=>{d.current?.scrollIntoView({behavior:`smooth`})},[t]);let m=e=>e?e.toDate().toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`}):``;return e?(0,Q.jsxs)(`div`,{className:`flex flex-col h-screen bg-gradient-to-b from-gray-50 to-gray-100 font-sans text-gray-800 max-w-4xl mx-auto w-full`,children:[(0,Q.jsxs)(`div`,{className:`sticky top-4 z-30 flex items-center gap-3 p-4 m-4 bg-white/70 backdrop-blur-md rounded-2xl shadow-lg transition-all duration-300 hover:shadow-xl`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold shadow-md`,children:e?.email?.charAt(0).toUpperCase()||`U`}),(0,Q.jsx)(`div`,{className:`absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white`,title:`Online`})]}),(0,Q.jsxs)(`div`,{className:`flex-1`,children:[(0,Q.jsx)(`h1`,{className:`text-lg font-bold text-gray-900`,children:`Chat Room`}),(0,Q.jsxs)(`p`,{className:`text-sm text-gray-500`,children:[t.length,` Messages`]})]}),(0,Q.jsxs)(`div`,{className:`flex items-center gap-1 bg-white/80 px-3 py-1 rounded-full`,children:[(0,Q.jsx)(`div`,{className:`w-2 h-2 bg-green-500 rounded-full`}),(0,Q.jsxs)(`span`,{className:`text-xs text-gray-600`,children:[s.size,` online`]})]})]}),(0,Q.jsxs)(`div`,{className:`flex-1 overflow-y-auto p-4 flex flex-col gap-4 max-w-full`,children:[a?(0,Q.jsx)(`div`,{className:`flex justify-center p-6`,children:(0,Q.jsxs)(`div`,{className:`flex gap-2`,children:[(0,Q.jsx)(`div`,{className:`w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce`}),(0,Q.jsx)(`div`,{className:`w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce`,style:{animationDelay:`0.16s`}}),(0,Q.jsx)(`div`,{className:`w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce`,style:{animationDelay:`0.32s`}})]})}):t.length===0?(0,Q.jsxs)(`div`,{className:`flex flex-col items-center justify-center text-gray-500 p-10 bg-white rounded-2xl shadow-lg m-5`,children:[(0,Q.jsx)(`div`,{className:`text-4xl mb-3 opacity-70`,children:`ðŸ’¬`}),(0,Q.jsx)(`div`,{className:`text-sm text-center max-w-xs`,children:`No messages yet. Start a conversation!`})]}):t.map(t=>(0,Q.jsxs)(`div`,{className:`flex ${t.userId===e.uid?`justify-end`:`justify-start`} animate-fade-in`,children:[t.userId!==e.uid&&(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`w-9 h-9 rounded-full flex items-center justify-center bg-white text-indigo-600 font-bold flex-shrink-0 shadow-sm mr-2`,children:t.userName?t.userName.charAt(0).toUpperCase():`U`}),s.has(t.userId)&&(0,Q.jsx)(`div`,{className:`absolute  bottom-[60px] right-7 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-white`,title:`Online`})]}),(0,Q.jsxs)(`div`,{className:`max-w-[72%] p-3 rounded-2xl relative shadow-md transition-all duration-300 hover:shadow-lg ${t.userId===e.uid?`bg-gradient-to-br from-indigo-50 to-indigo-100 border border-indigo-100 rounded-br-md`:`bg-white border border-gray-200 rounded-bl-md`}`,children:[(0,Q.jsx)(`div`,{className:`text-sm text-gray-800 leading-relaxed`,children:t.text}),(0,Q.jsx)(`div`,{className:`text-xs text-gray-400 text-right mt-2`,children:m(t.timestamp)})]}),t.userId===e.uid&&(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`w-9 h-9 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold flex-shrink-0 shadow-sm ml-2`,children:t.userName?t.userName.charAt(0).toUpperCase():`U`}),(0,Q.jsx)(`div`,{className:`absolute bottom-[60px] right-6 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-white`,title:`Online`})]})]},t.id)),(0,Q.jsx)(`div`,{ref:d})]}),(0,Q.jsxs)(`form`,{onSubmit:p,className:`flex items-center p-4 gap-3 sticky bottom-0 bg-white/70 backdrop-blur-md border-t border-gray-200`,children:[(0,Q.jsx)(`div`,{className:`flex-1 flex items-center bg-white p-2 pl-4 rounded-full shadow-md transition-all duration-300 focus-within:shadow-lg focus-within:border focus-within:border-indigo-500`,children:(0,Q.jsx)(`input`,{type:`text`,className:`flex-1 border-0 outline-none p-2 bg-transparent text-sm text-gray-800`,placeholder:`Type a message...`,value:r,onChange:e=>i(e.target.value)})}),(0,Q.jsx)(`button`,{type:`submit`,className:`w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white border-none cursor-pointer shadow-md transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none`,disabled:!r.trim(),children:(0,Q.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 24 24`,fill:`currentColor`,className:`w-4.5 h-4.5`,children:(0,Q.jsx)(`path`,{d:`M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z`})})})]})]}):(0,Q.jsx)(`div`,{className:`flex flex-col h-screen bg-gradient-to-b from-gray-50 to-gray-100 items-center justify-center font-sans text-gray-800`,children:(0,Q.jsxs)(`div`,{className:`text-center p-6 bg-white rounded-2xl shadow-lg max-w-md`,children:[(0,Q.jsx)(`h3`,{className:`text-xl font-bold text-gray-900 mb-2`,children:`Please log in to use chat`}),(0,Q.jsx)(`p`,{className:`text-gray-600`,children:`You need to be logged in to send and receive messages.`})]})})}var ke=()=>(0,Q.jsx)(`div`,{className:``,children:(0,Q.jsx)(`main`,{children:(0,Q.jsx)(`div`,{className:`max-w-7xl mx-auto sm:px-6 lg:px-8`,children:(0,Q.jsx)(`div`,{className:`px-4 py-8 sm:px-0`,children:(0,Q.jsx)(`div`,{className:`bg-white shadow overflow-hidden sm:rounded-lg p-6`,children:(0,Q.jsx)(Oe,{})})})})})}),Ae=()=>{let[e,t]=(0,Y.useState)(!1),{currentUser:n}=$(),r=y(),i=m(),{logout:a}=$(),o=async()=>{try{await a(),i(`/login`)}catch(e){console.error(`Failed to log out`,e)}},s=[{name:`Dashboard`,href:`/dashboard`,icon:oe},{name:`Deposits`,href:`/deposits`,icon:he},{name:`loans`,href:`/loans`,icon:se},{name:`Chat`,href:`/chat`,icon:ae},{name:`Users`,href:`/users`,icon:me},{name:`Payback`,href:`/payback`,icon:re},{name:`Settings`,href:`/settings`,icon:ie}],c=e=>r.pathname===e;return(0,Q.jsxs)(`div`,{className:`flex h-screen w-screen max-w-full bg-gray-50`,children:[(0,Q.jsx)(`div`,{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform ${e?`translate-x-0`:`-translate-x-full`} transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`,children:(0,Q.jsxs)(`div`,{className:`flex flex-col h-full`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center justify-between h-16 px-6 border-b border-gray-200`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[(0,Q.jsx)(`div`,{className:`flex-shrink-0`,children:(0,Q.jsx)(`div`,{className:`w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center`,children:(0,Q.jsx)(`span`,{className:`text-white font-bold`,children:`MB`})})}),(0,Q.jsx)(`div`,{className:`ml-3`,children:(0,Q.jsx)(`h1`,{className:`text-xl font-bold text-gray-900`,children:`MoneyBox`})})]}),(0,Q.jsx)(`button`,{onClick:()=>t(!1),className:`lg:hidden text-gray-500 hover:text-gray-700`,children:(0,Q.jsx)(G,{size:20})})]}),(0,Q.jsx)(`nav`,{className:`flex-1 px-4 py-6 overflow-y-auto`,children:(0,Q.jsx)(`ul`,{className:`space-y-1`,children:s.map(e=>(0,Q.jsx)(`li`,{children:(0,Q.jsxs)(g,{to:e.href,className:`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 ${c(e.href)?`bg-indigo-50 text-indigo-700`:`text-gray-700 hover:bg-gray-100`}`,children:[(0,Q.jsx)(e.icon,{className:`mr-3 h-5 w-5`}),e.name]})},e.name))})}),(0,Q.jsxs)(`div`,{className:`px-4 py-6 border-t border-gray-200`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center mb-4`,children:[(0,Q.jsx)(`div`,{className:`flex-shrink-0`,children:(0,Q.jsx)(`div`,{className:`w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center`,children:(0,Q.jsx)(`div`,{className:`w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold shadow-md`,children:n?.email?.charAt(0).toUpperCase()||`U`})})}),(0,Q.jsxs)(`div`,{className:`ml-3`,children:[(0,Q.jsxs)(`p`,{className:`text-sm font-medium text-gray-900`,children:[`Admin  is           `,n?.email?.slice(0,5).toUpperCase()||`U`]}),(0,Q.jsx)(`p`,{className:`text-xs text-gray-500`,children:n?.email?.slice(0,104).toLowerCase()||`U`})]})]}),(0,Q.jsxs)(`button`,{onClick:o,className:`flex items-center w-full px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200`,children:[(0,Q.jsx)(ge,{className:`mr-3 h-5 w-5`}),`Logout`]})]})]})}),(0,Q.jsxs)(`div`,{className:`flex-1 flex flex-col overflow-hidden`,children:[(0,Q.jsx)(`header`,{className:`bg-white shadow-sm z-10`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between h-16 px-6`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[(0,Q.jsx)(`button`,{onClick:()=>t(!0),className:`lg:hidden text-gray-500 hover:text-gray-700 mr-4`,children:(0,Q.jsx)(ue,{size:20})}),(0,Q.jsxs)(`h2`,{className:`text-xl font-semibold text-gray-800`,children:[r.pathname===`/dashboard`&&`ðŸ’° Dashboard`,r.pathname===`/deposits`&&`ðŸ’° Deposits Overview`,r.pathname===`/loans`&&`ðŸ’¸ loans Overview`,r.pathname===`/users`&&`ðŸ‘¥ Users Overview`,r.pathname===`/chat`&&`ðŸ‘¥ Users Overview`]})]}),(0,Q.jsxs)(`div`,{className:`flex items-center space-x-4`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`,children:(0,Q.jsx)(W,{className:`h-5 w-5 text-gray-400`})}),(0,Q.jsx)(`input`,{type:`text`,placeholder:`Search...`,className:`block w-64 pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`})]}),(0,Q.jsxs)(`button`,{className:`p-1 text-gray-500 hover:text-gray-700 relative`,children:[(0,Q.jsx)(z,{className:`h-6 w-6`}),(0,Q.jsx)(`span`,{className:`absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full`})]}),(0,Q.jsx)(`div`,{className:`flex items-center`,children:(0,Q.jsx)(`div`,{className:`w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center`,children:(0,Q.jsx)(le,{className:`h-5 w-5 text-indigo-600`})})}),(0,Q.jsxs)(`button`,{onClick:o,className:`flex items-center text-sm font-medium text-gray-700 hover:text-gray-900`,children:[(0,Q.jsx)(ge,{className:`mr-2 h-5 w-5`}),`Logout`]})]})]})}),(0,Q.jsx)(`main`,{className:`flex-1 overflow-y-auto bg-gray-50 p-6`,children:(0,Q.jsx)(`div`,{className:`h-full w-full`,children:(0,Q.jsx)(h,{})})})]})]})},je=()=>(0,Q.jsx)(Ae,{children:(0,Q.jsxs)(`div`,{className:`py-10`,children:[(0,Q.jsx)(`header`,{children:(0,Q.jsx)(`div`,{className:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`,children:(0,Q.jsx)(`h1`,{className:`text-3xl font-bold leading-tight text-gray-900`,children:`Money Box Admin Portal`})})}),(0,Q.jsx)(`main`,{children:(0,Q.jsx)(`div`,{className:`max-w-7xl mx-auto sm:px-6 lg:px-8`,children:(0,Q.jsx)(`div`,{className:`px-4 py-8 sm:px-0`,children:(0,Q.jsxs)(`div`,{className:`bg-white shadow overflow-hidden sm:rounded-lg`,children:[(0,Q.jsxs)(`div`,{className:`px-4 py-5 sm:px-6`,children:[(0,Q.jsx)(`h2`,{className:`text-lg leading-6 font-medium text-gray-900`,children:`Welcome to the Admin Portal`}),(0,Q.jsx)(`p`,{className:`mt-1 text-sm text-gray-500`,children:`Use the navigation menu to access different sections`})]}),(0,Q.jsx)(`div`,{className:`border-t border-gray-200`,children:(0,Q.jsx)(`div`,{className:`px-4 py-5 sm:p-6`,children:(0,Q.jsx)(`p`,{className:`text-gray-600`,children:`You are successfully logged in. Use the sidebar navigation to access different parts of the admin portal.`})})})]})})})})]})}),Me=()=>{let[e,t]=(0,Y.useState)([]),[n,r]=(0,Y.useState)([]),[i,a]=(0,Y.useState)(!0),[o,s]=(0,Y.useState)(null),[c,l]=(0,Y.useState)(``),[u,d]=(0,Y.useState)(`All`),[f,p]=(0,Y.useState)({});(0,Y.useEffect)(()=>{let e=k(j(Z,`users`)),t=F(e,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));r(t)},e=>{console.error(`Error loading users:`,e),s(`Failed to load users: `+e.message)});return()=>t()},[]),(0,Y.useEffect)(()=>{let e=k(j(Z,`loans`),C(`timestamp`,`desc`)),r=F(e,e=>{try{let r=e.docs.map(e=>({id:e.id,...e.data()})).map(e=>{let t=n.find(t=>t.uid===e.userId);return{...e,userName:t?t.fullName||`Unnamed User`:`Unknown User`}});t(r),a(!1)}catch(e){console.error(`Error merging loan data:`,e),s(`Error processing loan data: `+e.message),a(!1)}},e=>{console.error(`Firestore error:`,e),s(`Failed to load loans: `+e.message),a(!1)});return()=>r()},[n]);let m=e=>{switch(e){case`accepted`:return`bg-green-100 text-green-800`;case`denied`:return`bg-red-100 text-red-800`;case`Pending`:case`pending`:return`bg-yellow-100 text-yellow-800`;default:return`bg-gray-100 text-gray-800`}},h=async(e,t)=>{try{let n=P(Z,`loans`,e);await T(n,{status:t}),console.log(`Loan ${e} status updated to ${t}`)}catch(e){console.error(`Error updating loan status:`,e),s(`Failed to update loan status: `+e.message)}},g=e=>{if(!e)return`N/A`;if(e.seconds){let t=new Date(e.seconds*1e3);return t.toLocaleDateString()+` `+t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})}if(e.toDate){let t=e.toDate();return t.toLocaleDateString()+` `+t.toLocaleTimeString([],{hour:`2-digit`,minute:`2-digit`})}return e.toString()},_=e.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),v=e.filter(e=>e.status===`pending`).length,y=e.filter(e=>e.status===`accepted`).length,b=e.filter(e=>e.status===`denied`).length,x=e.filter(e=>e.status===`accepted`).reduce((e,t)=>e+(parseFloat(t.amount)||0),0),S=e.filter(e=>e.status===`denied`).reduce((e,t)=>e+(parseFloat(t.amount)||0),0),w=e.filter(e=>{let t=e.userName?.toLowerCase().includes(c.toLowerCase())||e.userId?.toLowerCase().includes(c.toLowerCase())||e.message?.toLowerCase().includes(c.toLowerCase()),n=u===`All`||e.status===u;return t&&n});return i?(0,Q.jsx)(`div`,{className:`flex items-center justify-center h-96`,children:(0,Q.jsxs)(`div`,{className:`text-center`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600`,children:`Loading loans...`})]})}):o?(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 text-center`,children:[(0,Q.jsxs)(`p`,{className:`text-red-500`,children:[`Error: `,o]}),(0,Q.jsx)(`button`,{onClick:()=>window.location.reload(),className:`mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200`,children:`Retry`})]}):(0,Q.jsxs)(`div`,{className:`space-y-6`,children:[(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6`,children:[(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total loans`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,_.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-blue-100`,children:(0,Q.jsx)(K,{className:`h-6 w-6 text-blue-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Pending loans`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:v})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-yellow-100`,children:(0,Q.jsx)(J,{className:`h-6 w-6 text-yellow-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Paid loans`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:y})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-green-100`,children:(0,Q.jsx)(_e,{className:`h-6 w-6 text-green-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Declined loans`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:b})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-red-100`,children:(0,Q.jsx)(H,{className:`h-6 w-6 text-red-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Accepted Amount`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,x.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-green-100`,children:(0,Q.jsx)(q,{className:`h-6 w-6 text-green-600`})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Declined Amount`}),(0,Q.jsxs)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:[`$`,S.toFixed(2)]})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-red-100`,children:(0,Q.jsx)(H,{className:`h-6 w-6 text-red-600`})})]})})]}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6`,children:(0,Q.jsxs)(`div`,{className:`flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0`,children:[(0,Q.jsx)(`h2`,{className:`text-lg font-medium text-gray-900`,children:`Loans Records`}),(0,Q.jsxs)(`div`,{className:`flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`,children:(0,Q.jsx)(W,{className:`h-5 w-5 text-gray-400`})}),(0,Q.jsx)(`input`,{type:`text`,placeholder:`Search by name, user ID or message...`,className:`block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`,value:c,onChange:e=>l(e.target.value)})]}),(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsxs)(`select`,{className:`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50`,value:u,onChange:e=>d(e.target.value),children:[(0,Q.jsx)(`option`,{value:`All`,children:`All Statuses`}),(0,Q.jsx)(`option`,{value:`Pending`,children:`Pending`}),(0,Q.jsx)(`option`,{value:`accepted`,children:`Paid`}),(0,Q.jsx)(`option`,{value:`denied`,children:`Declined`})]}),(0,Q.jsx)(`div`,{className:`absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none`,children:(0,Q.jsx)(pe,{className:`h-5 w-5 text-gray-400`})})]})]})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`User Name`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Amount`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Status`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Date`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Actions`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:w.length>0?w.map(e=>(0,Q.jsxs)(`tr`,{className:`hover:bg-gray-50 transition-colors duration-150`,children:[(0,Q.jsxs)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:[(0,Q.jsx)(`div`,{className:`text-sm font-semibold text-gray-900`,children:e.userName}),(0,Q.jsxs)(`div`,{className:`text-xs text-gray-500 italic`,children:[`ID: `,e.userId]})]}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsxs)(`div`,{className:`text-sm font-semibold text-gray-900`,children:[`$`,e.amount?parseFloat(e.amount).toFixed(2):`0.00`]})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${m(e.status)}`,children:e.status===`accepted`?`Paid`:e.status||`Pending`})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:g(e.timestamp)}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm font-medium`,children:(0,Q.jsxs)(`div`,{className:`flex items-center space-x-3`,children:[e.status===`pending`?(0,Q.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,Q.jsx)(`button`,{disabled:!!f[e.id],onClick:async()=>{if(window.confirm(`Mark this loan as Paid?`)){p(t=>({...t,[e.id]:!0}));try{await h(e.id,`accepted`)}finally{p(t=>{let n={...t};return delete n[e.id],n})}}},className:`px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200 disabled:opacity-50`,children:f[e.id]?`Processing...`:`Pay`}),(0,Q.jsx)(`button`,{disabled:!!f[e.id],onClick:async()=>{if(window.confirm(`Mark this loan as Declined?`)){p(t=>({...t,[e.id]:!0}));try{await h(e.id,`denied`)}finally{p(t=>{let n={...t};return delete n[e.id],n})}}},className:`px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50`,children:f[e.id]?`Processing...`:`Decline`})]}):(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:e.status===`accepted`?`Paid`:e.status}),e.imageUrl&&(0,Q.jsx)(`button`,{onClick:()=>window.open(e.imageUrl,`_blank`),className:`text-indigo-600 hover:text-indigo-900 flex items-center`,title:`View proof`,children:(0,Q.jsx)(fe,{className:`h-4 w-4`})})]})})]},e.id)):(0,Q.jsx)(`tr`,{children:(0,Q.jsx)(`td`,{colSpan:`5`,className:`px-6 py-4 text-center text-sm text-gray-500`,children:`No loans found.`})})})]})})})]})},Ne=()=>{let[e,t]=(0,Y.useState)([]),[n,r]=(0,Y.useState)(!0),[i,a]=(0,Y.useState)(null),[o,s]=(0,Y.useState)(``),[c,l]=(0,Y.useState)(!1),[u,d]=(0,Y.useState)(null),[f,p]=(0,Y.useState)([]),[m,h]=(0,Y.useState)([]),[g,_]=(0,Y.useState)(!1),[v,y]=(0,Y.useState)(!1),[b,x]=(0,Y.useState)(null),[S,w]=(0,Y.useState)(null),[T,E]=(0,Y.useState)({}),D=(0,Y.useRef)(null),O=(0,Y.useRef)(null);(0,Y.useEffect)(()=>{if(!Z){a(`Firestore instance not available`),r(!1);return}let e=k(j(Z,`users`),C(`createdAt`,`desc`)),n=F(e,e=>{try{let n=e.docs.map(e=>({id:e.id,...e.data()}));t(n),r(!1)}catch(e){console.error(`Error processing users snapshot:`,e),a(`Failed to process users data`),r(!1)}},e=>{console.error(`Error fetching users:`,e),e.code===`permission-denied`?a(`Permission denied. Check Firestore rules.`):a(`Failed to load users: `+(e.message||`Unknown error`)),r(!1)});return()=>n()},[]),(0,Y.useEffect)(()=>{if(D.current&&=(D.current(),null),O.current&&=(O.current(),null),!u){p([]),h([]);return}_(!0),x(null);let e=k(j(Z,`deposits`),C(`timestamp`,`desc`));D.current=F(e,e=>{try{let t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.userId===u.uid);p(t),_(!1)}catch(e){console.error(`Error processing deposits snapshot:`,e),x(`Failed to process deposits data`),_(!1)}},e=>{console.error(`Error fetching deposits:`,e),x(`Failed to load deposits: `+(e.message||`Unknown error`)),_(!1)}),y(!0),w(null);let t=k(j(Z,`loans`),C(`timestamp`,`desc`));return O.current=F(t,e=>{try{let t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.userId===u.uid);h(t),y(!1)}catch(e){console.error(`Error processing loans snapshot:`,e),w(`Failed to process loans data`),y(!1)}},e=>{console.error(`Error fetching loans:`,e),w(`Failed to load loans: `+(e.message||`Unknown error`)),y(!1)}),()=>{D.current&&=(D.current(),null),O.current&&=(O.current(),null)}},[u]);let A=e=>{if(!e)return`N/A`;if(e.seconds)return new Date(e.seconds*1e3).toLocaleString();if(e.toDate)return e.toDate().toLocaleString();try{return new Date(e).toLocaleString()}catch{return String(e)}},M=e=>{switch(e?.toLowerCase()){case`accepted`:return`bg-green-100 text-green-800`;case`denied`:case`rejected`:return`bg-red-100 text-red-800`;case`pending`:return`bg-yellow-100 text-yellow-800`;default:return`bg-gray-100 text-gray-800`}},N=e=>{d(e),l(!0)},P=()=>{l(!1)},I=e=>{window.open(e,`_blank`)},L=(e,t)=>{let n=document.createElement(`a`);n.href=e,n.download=t||`proof-image.jpg`,document.body.appendChild(n),n.click(),document.body.removeChild(n)},R=f.reduce((e,t)=>e+(t.amount||0),0),z=m.reduce((e,t)=>e+(t.amount||0),0);f.filter(e=>e.status===`pending`).length,f.filter(e=>e.status===`accepted`).length,f.filter(e=>e.status===`denied`||e.status===`rejected`).length,m.filter(e=>e.status===`pending`).length,m.filter(e=>e.status===`accepted`).length,m.filter(e=>e.status===`denied`||e.status===`rejected`).length;let B=e.filter(e=>{let t=o.trim().toLowerCase();return t?(e.fullName||``).toLowerCase().includes(t)||(e.email||``).toLowerCase().includes(t)||(e.phoneNumber||``).toLowerCase().includes(t)||(e.uid||``).toLowerCase().includes(t):!0});return n?(0,Q.jsx)(`div`,{className:`flex items-center justify-center h-64`,children:(0,Q.jsxs)(`div`,{className:`text-center`,children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600`,children:`Loading users...`})]})}):i?(0,Q.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 text-center`,children:[(0,Q.jsxs)(`p`,{className:`text-red-500`,children:[`Error: `,i]}),(0,Q.jsx)(`button`,{onClick:()=>window.location.reload(),className:`mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200`,children:`Retry`})]}):(0,Q.jsxs)(`div`,{className:`space-y-6`,children:[(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-4 gap-6`,children:[(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 md:col-span-1`,children:(0,Q.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Total Users`}),(0,Q.jsx)(`p`,{className:`mt-2 text-3xl font-bold text-gray-900`,children:e.length})]}),(0,Q.jsx)(`div`,{className:`p-3 rounded-full bg-green-100`,children:(0,Q.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,className:`h-6 w-6 text-green-600`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`,children:(0,Q.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M17 20h5v-2a4 4 0 00-4-4h-1M9 20H4v-2a4 4 0 014-4h1m0-4a4 4 0 100-8 4 4 0 000 8z`})})})]})}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm p-6 md:col-span-3`,children:(0,Q.jsxs)(`div`,{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0`,children:[(0,Q.jsx)(`h2`,{className:`text-lg font-medium text-gray-900`,children:`User Records`}),(0,Q.jsx)(`div`,{className:`flex items-center w-full sm:w-64`,children:(0,Q.jsxs)(`div`,{className:`relative w-full`,children:[(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none`,children:(0,Q.jsx)(W,{className:`h-5 w-5 text-gray-400`})}),(0,Q.jsx)(`input`,{type:`text`,placeholder:`Search users...`,className:`block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`,value:o,onChange:e=>s(e.target.value)})]})})]})})]}),(0,Q.jsx)(`div`,{className:`bg-white rounded-2xl shadow-sm overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`User`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Email`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Phone`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Gender`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Age`}),(0,Q.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Joined`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:B.length>0?B.map(e=>(0,Q.jsxs)(`tr`,{className:`hover:bg-gray-50 transition-colors duration-150 cursor-pointer`,onClick:()=>N(e),children:[(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap`,children:(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[e.imageUrl?(0,Q.jsx)(`img`,{src:e.imageUrl,alt:e.fullName||`avatar`,className:`h-10 w-10 rounded-full object-cover`,onError:e=>{e.target.style.display=`none`}}):(0,Q.jsx)(`div`,{className:`h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-medium text-gray-700`,children:(e.fullName||`U`).split(` `).map(e=>e[0]).slice(0,2).join(``).toUpperCase()}),(0,Q.jsxs)(`div`,{className:`ml-3`,children:[(0,Q.jsx)(`div`,{className:`text-sm font-medium text-gray-900`,children:e.fullName||`No name`}),(0,Q.jsx)(`div`,{className:`text-xs text-gray-500`,children:e.uid||``})]})]})}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:e.email||`N/A`}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:e.phoneNumber||`N/A`}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize`,children:e.gender||`N/A`}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:e.age||`N/A`}),(0,Q.jsx)(`td`,{className:`px-6 py-4 whitespace-nowrap text-sm text-gray-500`,children:A(e.createdAt)})]},e.id)):(0,Q.jsx)(`tr`,{children:(0,Q.jsx)(`td`,{colSpan:`6`,className:`px-6 py-4 text-center text-sm text-gray-500`,children:`No users found.`})})})]})})}),c&&u&&(0,Q.jsx)(`div`,{className:`fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center p-4`,children:(0,Q.jsxs)(`div`,{className:`bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-auto`,children:[(0,Q.jsxs)(`div`,{className:`sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center`,children:[(0,Q.jsxs)(`h2`,{className:`text-xl font-semibold text-gray-900`,children:[`User Details: `,u.fullName]}),(0,Q.jsx)(`button`,{onClick:P,className:`p-1 rounded-full hover:bg-gray-100 transition-colors`,children:(0,Q.jsx)(G,{className:`h-5 w-5 text-gray-500`})})]}),(0,Q.jsxs)(`div`,{className:`p-6`,children:[(0,Q.jsxs)(`div`,{className:`bg-gray-50 rounded-lg p-4 mb-6`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center mb-4`,children:[u.imageUrl?(0,Q.jsx)(`img`,{src:u.imageUrl,alt:u.fullName||`avatar`,className:`h-16 w-16 rounded-full object-cover mr-4`}):(0,Q.jsx)(`div`,{className:`h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center text-xl font-medium text-gray-700 mr-4`,children:(u.fullName||`U`).split(` `).map(e=>e[0]).slice(0,2).join(``).toUpperCase()}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900`,children:u.fullName||`No name`}),(0,Q.jsxs)(`p`,{className:`text-sm text-gray-500`,children:[`ID: `,u.uid||`N/A`]})]})]}),(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-4`,children:[(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Email`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:u.email||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Phone Number`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:u.phoneNumber||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`MoMo Number`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:u.momoNumber||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Credit card Number`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:u.creditCardNumber||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Gender`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900 capitalize`,children:u.gender||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Age`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:u.age||`N/A`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`p`,{className:`text-sm font-medium text-gray-500`,children:`Joined Date`}),(0,Q.jsx)(`p`,{className:`text-sm text-gray-900`,children:A(u.createdAt)})]})]})]}),(0,Q.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6 mb-6`,children:[(0,Q.jsxs)(`div`,{className:`bg-white rounded-lg shadow p-4`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center mb-4`,children:[(0,Q.jsx)(`div`,{className:`p-2 rounded-full bg-green-100 mr-3`,children:(0,Q.jsx)(V,{className:`h-6 w-6 text-green-600`})}),(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900`,children:`Deposits Summary`})]}),(0,Q.jsx)(`div`,{className:`space-y-3`,children:(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Total Amount:`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,R.toFixed(2)]})]})})]}),(0,Q.jsxs)(`div`,{className:`bg-white rounded-lg shadow p-4`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center mb-4`,children:[(0,Q.jsx)(`div`,{className:`p-2 rounded-full bg-blue-100 mr-3`,children:(0,Q.jsx)(de,{className:`h-6 w-6 text-blue-600`})}),(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900`,children:`Loans Summary`})]}),(0,Q.jsx)(`div`,{className:`space-y-3`,children:(0,Q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,Q.jsx)(`span`,{className:`text-sm text-gray-500`,children:`Total Amount:`}),(0,Q.jsxs)(`span`,{className:`text-sm font-medium text-gray-900`,children:[`$`,z.toFixed(2)]})]})})]})]}),(0,Q.jsxs)(`div`,{className:`mb-6`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900 mb-4`,children:`Deposits`}),g?(0,Q.jsx)(`div`,{className:`flex justify-center py-4`,children:(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600`})}):b?(0,Q.jsx)(`div`,{className:`bg-red-50 p-4 rounded-md`,children:(0,Q.jsx)(`p`,{className:`text-sm text-red-800`,children:b})}):f.length>0?(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Amount`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Status`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Date`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Message`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Proof`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:f.map(e=>(0,Q.jsxs)(`tr`,{children:[(0,Q.jsxs)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-900`,children:[`$`,e.amount||`0`]}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap`,children:(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(e.status)}`,children:e.status||`Unknown`})}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-500`,children:A(e.timestamp)}),(0,Q.jsx)(`td`,{className:`px-4 py-3 text-sm text-gray-900 max-w-xs truncate`,title:e.message,children:e.message||`N/A`}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-500`,children:e.proofImage?(0,Q.jsxs)(`div`,{className:`flex space-x-2`,children:[(0,Q.jsx)(`button`,{onClick:()=>I(e.proofImage),className:`text-indigo-600 hover:text-indigo-900`,title:`View`,children:(0,Q.jsx)(U,{className:`h-5 w-5`})}),(0,Q.jsx)(`button`,{onClick:()=>L(e.proofImage,`deposit-proof-${e.id}.jpg`),className:`text-indigo-600 hover:text-indigo-900`,title:`Download`,children:(0,Q.jsx)(ce,{className:`h-5 w-5`})})]}):`N/A`})]},e.id))})]})}):(0,Q.jsx)(`div`,{className:`text-center py-4 text-sm text-gray-500`,children:`No deposits found.`})]}),(0,Q.jsxs)(`div`,{children:[(0,Q.jsx)(`h3`,{className:`text-lg font-medium text-gray-900 mb-4`,children:`Loans`}),v?(0,Q.jsx)(`div`,{className:`flex justify-center py-4`,children:(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600`})}):S?(0,Q.jsx)(`div`,{className:`bg-red-50 p-4 rounded-md`,children:(0,Q.jsx)(`p`,{className:`text-sm text-red-800`,children:S})}):m.length>0?(0,Q.jsx)(`div`,{className:`overflow-x-auto`,children:(0,Q.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,Q.jsx)(`thead`,{className:`bg-gray-50`,children:(0,Q.jsxs)(`tr`,{children:[(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Amount`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Status`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Date`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Reason`}),(0,Q.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider`,children:`Approved By`})]})}),(0,Q.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-200`,children:m.map(e=>(0,Q.jsxs)(`tr`,{children:[(0,Q.jsxs)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-900`,children:[`$`,e.amount||`0`]}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap`,children:(0,Q.jsx)(`span`,{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${M(e.status)}`,children:e.status||`Unknown`})}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-500`,children:A(e.timestamp)}),(0,Q.jsx)(`td`,{className:`px-4 py-3 text-sm text-gray-900 max-w-xs truncate`,title:e.reason,children:e.reason||`N/A`}),(0,Q.jsx)(`td`,{className:`px-4 py-3 whitespace-nowrap text-sm text-gray-500`,children:e.approvedBy||`N/A`})]},e.id))})]})}):(0,Q.jsx)(`div`,{className:`text-center py-4 text-sm text-gray-500`,children:`No loans found.`})]})]})]})})]})},Pe=()=>{let[e,r]=(0,Y.useState)(`10.00`),[l,u]=(0,Y.useState)(!0),[d,f]=(0,Y.useState)(!1),[p,m]=(0,Y.useState)(null),[h,g]=(0,Y.useState)(`success`),[_,v]=(0,Y.useState)([]),[y,b]=(0,Y.useState)(!1),[x,S]=(0,Y.useState)(null);return(0,Y.useEffect)(()=>{(async()=>{try{let e=k(j(Z,`interest`),C(`timestamp`,`desc`),M(10)),t=await O(e);if(t.empty)r(`10.00`);else{let e=t.docs[0];r(e.data().interest.toFixed(2)),S(e.id);let n=t.docs.map(e=>({date:new Date(e.data().timestamp?.toDate()||Date.now()).toLocaleDateString(),rate:parseFloat(e.data().interest)})).reverse();v(n)}}catch(e){console.error(`Error fetching interest:`,e),m(`Failed to load interest rate`),g(`error`),setTimeout(()=>m(null),3e3)}finally{u(!1)}})()},[]),l?(0,Q.jsx)(`div`,{className:`flex justify-center items-center min-h-screen px-4`,children:(0,Q.jsxs)(`div`,{className:`bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full max-w-md text-center`,children:[(0,Q.jsx)(`div`,{className:`inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500`}),(0,Q.jsx)(`p`,{className:`mt-4 text-gray-600 dark:text-gray-300`,children:`Loading interest rate...`})]})}):(0,Q.jsxs)(`div`,{className:`flex justify-center items-center min-h-screen px-4 bg-gray-50 dark:bg-gray-900`,children:[(0,Q.jsxs)(`div`,{className:`bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-4 sm:p-6 md:p-10 w-full max-w-md`,children:[(0,Q.jsx)(`h2`,{className:`text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6 text-center`,children:`Interest Rate Settings`}),(0,Q.jsxs)(`div`,{className:`mb-6`,children:[(0,Q.jsx)(`label`,{className:`block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2`,children:`Current Interest Rate (%)`}),(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`input`,{type:`number`,step:`0.01`,min:`1`,max:`100`,value:e,onChange:e=>r(e.target.value),className:`border border-gray-300 dark:border-gray-700 rounded-lg p-3 w-full focus:ring-2 focus:ring-blue-500 outline-none pr-12`,disabled:d,placeholder:`Enter interest rate (1â€“100)`}),(0,Q.jsx)(`div`,{className:`absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500`,children:`%`})]}),(0,Q.jsx)(`p`,{className:`text-xs text-gray-500 mt-1`,children:`Enter as a percentage (e.g., 5 for 5%)`})]}),(0,Q.jsx)(`button`,{onClick:async()=>{if(isNaN(e)||e<1||e>100){m(`Please enter a valid interest rate between 1% and 100%`),g(`error`),setTimeout(()=>m(null),3e3);return}f(!0);try{let t=new Date;if(x){let n=P(Z,`interest`,x);await T(n,{interest:Number(e),timestamp:t})}else await w(P(Z,`interest`,`globalRate`),{interest:Number(e),timestamp:t}),S(`globalRate`);m(`Interest rate updated successfully!`),g(`success`),v(n=>[...n.slice(-9),{date:t.toLocaleDateString(),rate:Number(e)}])}catch(e){console.error(`Error updating interest:`,e),m(`Failed to update interest rate`),g(`error`)}finally{f(!1),setTimeout(()=>m(null),3e3)}},disabled:d,className:`bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 w-full disabled:opacity-50 flex items-center justify-center text-sm sm:text-base`,children:d?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(`div`,{className:`animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2`}),`Saving...`]}):`Save Changes`}),(0,Q.jsx)(`div`,{className:`mt-6 text-center`,children:(0,Q.jsxs)(`button`,{onClick:()=>b(!y),className:`text-blue-600 dark:text-blue-400 text-sm font-medium hover:underline`,children:[y?`Hide`:`Show`,` Rate History`]})}),y&&_.length>0&&(0,Q.jsxs)(`div`,{className:`mt-6 pt-6 border-t border-gray-200 dark:border-gray-700`,children:[(0,Q.jsx)(`h3`,{className:`text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4`,children:`Interest Rate History`}),(0,Q.jsx)(`div`,{className:`h-48`,children:(0,Q.jsx)(a,{width:`100%`,height:`100%`,children:(0,Q.jsxs)(o,{data:_,children:[(0,Q.jsx)(s,{strokeDasharray:`3 3`,stroke:`#e0e0e0`}),(0,Q.jsx)(i,{dataKey:`date`,tick:{fontSize:12}}),(0,Q.jsx)(c,{tick:{fontSize:12},domain:[`dataMin - 0.5`,`dataMax + 0.5`]}),(0,Q.jsx)(n,{formatter:e=>`${e.toFixed(2)}%`,contentStyle:{backgroundColor:`rgba(255, 255, 255, 0.9)`,border:`1px solid #ccc`,borderRadius:`4px`}}),(0,Q.jsx)(t,{type:`monotone`,dataKey:`rate`,stroke:`#3b82f6`,strokeWidth:2,dot:{fill:`#3b82f6`,r:4},activeDot:{r:6}})]})})})]})]}),p&&(0,Q.jsx)(`div`,{className:`fixed top-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg text-white font-semibold shadow-md transition-all duration-300 ${h===`success`?`bg-green-500`:`bg-red-500`}`,children:p})]})};function Fe({children:e}){let{currentUser:t}=$();return t?e:(0,Q.jsx)(v,{to:`/login`})}function Ie({children:e}){let{currentUser:t}=$();return t?(0,Q.jsx)(v,{to:`/dashboard`}):e}function Le(){return(0,Q.jsxs)(_,{children:[(0,Q.jsx)(p,{path:`/login`,element:(0,Q.jsx)(Ie,{children:(0,Q.jsx)(Se,{})})}),(0,Q.jsx)(p,{path:`/signup`,element:(0,Q.jsx)(Ie,{children:(0,Q.jsx)(Ce,{})})}),(0,Q.jsxs)(p,{path:`/`,element:(0,Q.jsx)(Fe,{children:(0,Q.jsx)(Ae,{})}),children:[(0,Q.jsx)(p,{index:!0,element:(0,Q.jsx)(je,{})}),(0,Q.jsx)(p,{path:`profile`,element:(0,Q.jsx)(we,{})}),(0,Q.jsx)(p,{path:`dashboard`,element:(0,Q.jsx)(Te,{})}),(0,Q.jsx)(p,{path:`deposits`,element:(0,Q.jsx)(De,{})}),(0,Q.jsx)(p,{path:`loans`,element:(0,Q.jsx)(Me,{})}),(0,Q.jsx)(p,{path:`payback`,element:(0,Q.jsx)(Ee,{})}),(0,Q.jsx)(p,{path:`users`,element:(0,Q.jsx)(Ne,{})}),(0,Q.jsx)(p,{path:`settings`,element:(0,Q.jsx)(Pe,{})}),(0,Q.jsx)(p,{path:`chat`,element:(0,Q.jsx)(ke,{})})]})]})}var Re=Le;(0,ve.createRoot)(document.getElementById(`root`)).render((0,Q.jsx)(Y.StrictMode,{children:(0,Q.jsx)(xe,{children:(0,Q.jsx)(b,{children:(0,Q.jsx)(Re,{})})})}));