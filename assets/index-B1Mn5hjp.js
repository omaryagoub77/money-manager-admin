import{r as ue}from"./rolldown-runtime-CjiBMUN4.js";import{a as ne,c as ie,d as Ue,i as le,l as de,n as Ne,o as oe,r as ce,s as fe,t as Ee}from"./charting-mCjb7GWK.js";import{t as Le}from"./react-dom-COd6vK1M.js";import{a as K,c as he,i as Pe,n as ge,o as Fe,r as be,s as Te,t as Ie}from"./react-router-CShHLuBK.js";import{_ as Re,a as Me,c as V,d as $e,f as X,g as Oe,h as _e,i as ze,l as W,m as Be,n as O,o as qe,p as He,r as Q,s as q,t as Ke,u as Z,v as We}from"./firebase-0vrT_m7P.js";import{t as Ye}from"./react-xg8gCaOR.js";import{C as Qe,D as Ve,E as Ge,O as Xe,S as Je,T as Ze,_ as ae,a as es,b as se,c as ss,d as ts,f as as,g as we,h as pe,i as rs,l as ns,m as is,n as ls,o as ee,p as ve,r as Se,s as ds,t as re,u as je,v as me,w as os,x as xe,y as De}from"./lucide-icons-DuvOX9XH.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))v(p);new MutationObserver(p=>{for(const h of p)if(h.type==="childList")for(const S of h.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&v(S)}).observe(document,{childList:!0,subtree:!0});function U(p){const h={};return p.integrity&&(h.integrity=p.integrity),p.referrerPolicy&&(h.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?h.credentials="include":p.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function v(p){if(p.ep)return;p.ep=!0;const h=U(p);fetch(p.href,h)}})();var cs=ue(Le()),s=ue(Ue()),Ae=We({apiKey:"AIzaSyAGm3bzsCxYSARcgVn41ta_EOut9fauWr0",authDomain:"ecommerce-74229.firebaseapp.com",projectId:"ecommerce-74229",storageBucket:"ecommerce-74229.firebasestorage.app",messagingSenderId:"47160479095",appId:"1:47160479095:web:0dd3a844d5d5c3847ea572",measurementId:"G-47FYXTR59Z"}),te=Be(Ae),C=Me(Ae),e=ue(Ye()),ke=(0,s.createContext)();const J=()=>(0,s.useContext)(ke),ms=({children:i})=>{const[g,U]=(0,s.useState)(null),[v,p]=(0,s.useState)(!0),h=(m,x)=>He(te,m,x),S=(m,x)=>Oe(te,m,x),y=()=>Re(te);(0,s.useEffect)(()=>_e(te,m=>{U(m),p(!1)}),[]);const k={currentUser:g,signup:h,login:S,logout:y};return(0,e.jsx)(ke.Provider,{value:k,children:v?(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):i})};function xs(){const i=(0,s.useRef)(),g=(0,s.useRef)(),{login:U}=J(),v=he(),[p,h]=(0,s.useState)(""),[S,y]=(0,s.useState)(!1),k=async m=>{m.preventDefault();try{h(""),y(!0),await U(i.current.value,g.current.value),v("/dashboard")}catch{h("Failed to sign in. Please check your credentials and try again.")}y(!1)};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4",children:(0,e.jsx)("div",{className:"w-full max-w-md",children:(0,e.jsxs)("form",{onSubmit:k,className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4",children:(0,e.jsx)("span",{className:"text-white font-bold text-xl",children:"MB"})}),(0,e.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),(0,e.jsx)("p",{className:"text-gray-600 mt-2",children:"Sign in to your account"})]}),p&&(0,e.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm",children:p}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,e.jsx)("input",{type:"email",id:"email",ref:i,placeholder:"Enter your email",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,e.jsx)("input",{type:"password",id:"password",ref:g,placeholder:"Enter your password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsx)("button",{disabled:S,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50",children:S?"Signing In...":"Sign In"}),(0,e.jsxs)("p",{className:"mt-6 text-center text-gray-600",children:["Don't have an account?"," ",(0,e.jsx)(ge,{to:"/signup",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Sign Up"})]})]})})})}function us(){const i=(0,s.useRef)(),g=(0,s.useRef)(),U=(0,s.useRef)(),{signup:v}=J(),p=he(),[h,S]=(0,s.useState)(""),[y,k]=(0,s.useState)(!1),m=async x=>{if(x.preventDefault(),g.current.value!==U.current.value)return S("Passwords do not match");if(g.current.value.length<6)return S("Password should be at least 6 characters");try{S(""),k(!0),await v(i.current.value,g.current.value),p("/dashboard")}catch{S("Failed to create an account. Please try again.")}k(!1)};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4",children:(0,e.jsx)("div",{className:"w-full max-w-md",children:(0,e.jsxs)("form",{onSubmit:m,className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4",children:(0,e.jsx)("span",{className:"text-white font-bold text-xl",children:"MB"})}),(0,e.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),(0,e.jsx)("p",{className:"text-gray-600 mt-2",children:"Sign up to get started"})]}),h&&(0,e.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm",children:h}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,e.jsx)("input",{type:"email",id:"email",ref:i,placeholder:"Enter your email",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,e.jsx)("input",{type:"password",id:"password",ref:g,placeholder:"Create a password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,e.jsx)("input",{type:"password",id:"confirmPassword",ref:U,placeholder:"Confirm your password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsx)("button",{disabled:y,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50",children:y?"Creating Account...":"Sign Up"}),(0,e.jsxs)("p",{className:"mt-6 text-center text-gray-600",children:["Already have an account?"," ",(0,e.jsx)(ge,{to:"/login",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Sign In"})]})]})})})}var hs=()=>(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{children:"Create your porfile"}),(0,e.jsxs)("form",{action:"",children:[(0,e.jsx)("input",{type:"text",placeholder:"Your full name "}),(0,e.jsx)("input",{type:"email",placeholder:"Your email",name:"",id:""}),(0,e.jsx)("input",{type:"number",placeholder:"You phone number ",name:"",id:""}),(0,e.jsx)("input",{type:"number",placeholder:"You Age  ",name:"",id:""}),(0,e.jsxs)("option",{value:"",children:[(0,e.jsx)("select",{name:"male",id:"",children:"Male"}),(0,e.jsx)("select",{name:"female",id:"",children:"Female"})]}),(0,e.jsx)("input",{type:"file",placeholder:"Upload your photo"}),(0,e.jsx)("button",{type:"submit",children:"Create account"})]})]})}),gs=hs,ps=()=>{const[i,g]=(0,s.useState)(0),[U,v]=(0,s.useState)(0),[p,h]=(0,s.useState)(0),[S,y]=(0,s.useState)(0),[k,m]=(0,s.useState)(!1),[x,T]=(0,s.useState)(!1),[b,L]=(0,s.useState)(!1),[P,I]=(0,s.useState)([]),[o,j]=(0,s.useState)([]),[N,E]=(0,s.useState)([]),[F,$]=(0,s.useState)(!0),_=n=>new Date(n).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",hour12:!0});(0,s.useEffect)(()=>{if(!C){L("Firestore instance not available"),$(!1);return}const n=W(O(C,"users"),V("createdAt","desc")),u=q(n,a=>{try{const c=a.docs.map(f=>({id:f.id,...f.data()}));E(c),y(c.length),$(!1),L(!1)}catch(c){console.error("Error processing users snapshot:",c),L("Failed to process users data"),$(!1)}},a=>{console.error("Error fetching users:",a),a.code==="permission-denied"?L("Permission denied. Check Firestore rules."):L("Failed to load users: "+(a.message||"Unknown error")),$(!1)});return()=>u()},[]);const z=({active:n,payload:u,label:a})=>{if(n&&u&&u.length){const c=u[0].payload;return(0,e.jsxs)("div",{className:"bg-white p-4 border border-gray-200 shadow-lg rounded-md",children:[(0,e.jsx)("p",{className:"font-medium text-gray-900",children:_(c.timestamp)}),(0,e.jsxs)("p",{className:"text-indigo-600",children:["Deposits: $",c.deposits.toFixed(2)]}),(0,e.jsxs)("p",{className:"text-red-600",children:["loans: $",c.loans.toFixed(2)]})]})}return null},l=(n,u,a=20)=>{const c=[];return n.forEach(f=>{const R=f.timestamp?.toDate?.()||new Date(f.timestamp);c.push({timestamp:R,name:R.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),deposits:Number(f.amount)||0,loans:0})}),u.forEach(f=>{const R=f.timestamp?.toDate?.()||new Date(f.timestamp);c.push({timestamp:R,name:R.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),deposits:0,loans:Number(f.amount)||0})}),c.sort((f,R)=>f.timestamp-R.timestamp),c.slice(-a)};(0,s.useEffect)(()=>{if(!C){console.error("Firestore database instance not available"),m(!0),T(!0);return}let n=[],u=[];const a=W(O(C,"deposits"),V("timestamp","desc")),c=q(a,M=>{try{let B=0;n=[],M.forEach(r=>{const D=r.data();D.amount&&(B+=parseFloat(D.amount)),n.push({id:r.id,...D,timestamp:D.timestamp})}),g(B),m(!1);const G=l(n,u);I(G),j(r=>[...n.slice(0,3).map(D=>({id:D.id,type:"deposit",userId:D.userId,amount:D.amount,timestamp:D.timestamp?.toDate?.()||new Date})),...r].slice(0,6))}catch(B){console.error("Error processing deposits data:",B),m(!0)}},M=>{console.error("Error fetching deposits:",M),m(!0)}),f=W(O(C,"loans"),V("timestamp","desc")),R=q(f,M=>{try{let B=0,G=0;u=[],M.forEach(D=>{const A=D.data();A.amount&&(B+=parseFloat(A.amount)),A.status==="pending"&&(G+=1),u.push({id:D.id,...A,timestamp:A.timestamp})}),v(B),h(G),T(!1);const r=l(n,u);I(r),j(D=>[...u.slice(0,3).map(A=>({id:A.id,type:"cashout",userId:A.userId,amount:A.amount,status:A.status,timestamp:A.timestamp?.toDate?.()||new Date})),...D].slice(0,6))}catch(B){console.error("Error processing loans data:",B),T(!0)}},M=>{console.error("Error fetching loans:",M),T(!0)});return()=>{c(),R()}},[]);const w=n=>`$${n.toFixed(2)}`,t=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),d=[{id:1,name:"Total Deposits",value:k?"N/A":w(i),change:"+12.5%",changeType:"positive",icon:ae,iconColor:"bg-indigo-500"},{id:2,name:"Total loans",value:x?"N/A":w(U),change:"+8.2%",changeType:"positive",icon:me,iconColor:"bg-red-500"},{id:3,name:"Pending loans",value:x?"N/A":p,change:"+3.1%",changeType:"negative",icon:Xe,iconColor:"bg-yellow-500"},{id:4,name:"Total Users",value:b?"N/A":S,change:"+5.4%",changeType:"positive",icon:Se,iconColor:"bg-green-500"}];return F?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:d.map(n=>(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 transition-all duration-200 hover:shadow-md",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:n.name}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:n.value})]}),(0,e.jsx)("div",{className:`p-3 rounded-full ${n.iconColor}`,children:(0,e.jsx)(n.icon,{className:"h-6 w-6 text-white"})})]}),(0,e.jsxs)("div",{className:"mt-4 flex items-center",children:[n.changeType==="positive"?(0,e.jsx)(Ge,{className:"h-4 w-4 text-green-500"}):(0,e.jsx)(Ve,{className:"h-4 w-4 text-red-500"}),(0,e.jsx)("span",{className:`ml-1 text-sm font-medium ${n.changeType==="positive"?"text-green-500":"text-red-500"}`,children:n.change}),(0,e.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"from last month"})]})]},n.id))}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Live Transactions"}),(0,e.jsx)("div",{className:"h-80 overflow-x-hidden",children:(0,e.jsx)(de,{width:"100%",height:"100%",children:(0,e.jsxs)(Ee,{data:P,margin:{top:5,right:30,left:20,bottom:5},children:[(0,e.jsx)(oe,{strokeDasharray:"3 3"}),(0,e.jsx)(le,{dataKey:"name",tick:{fontSize:10},interval:0,minTickGap:15}),(0,e.jsx)(ce,{}),(0,e.jsx)(ie,{content:(0,e.jsx)(z,{})}),(0,e.jsx)(fe,{dataKey:"deposits",fill:"#4f46e5",name:"Deposits",isAnimationActive:!0,animationDuration:800,animationEasing:"ease-in-out"}),(0,e.jsx)(fe,{dataKey:"loans",fill:"#ef4444",name:"loans",isAnimationActive:!0,animationDuration:800,animationEasing:"ease-in-out"})]})})})]}),(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Transaction Trend"}),(0,e.jsx)("div",{className:"h-80 overflow-x-hidden",children:(0,e.jsx)(de,{width:"100%",height:"100%",children:(0,e.jsxs)(Ne,{data:P,margin:{top:5,right:30,left:20,bottom:5},children:[(0,e.jsx)(oe,{strokeDasharray:"3 3"}),(0,e.jsx)(le,{dataKey:"name",tick:{fontSize:10},interval:0,minTickGap:15}),(0,e.jsx)(ce,{}),(0,e.jsx)(ie,{content:(0,e.jsx)(z,{})}),(0,e.jsx)(ne,{type:"monotone",dataKey:"deposits",stroke:"#4f46e5",activeDot:{r:8},name:"Deposits",isAnimationActive:!0,animationDuration:800,animationEasing:"ease-in-out"}),(0,e.jsx)(ne,{type:"monotone",dataKey:"loans",stroke:"#ef4444",name:"loans",isAnimationActive:!0,animationDuration:800,animationEasing:"ease-in-out"})]})})})]})]}),(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Activity"}),(0,e.jsx)("button",{className:"text-sm font-medium text-indigo-600 hover:text-indigo-800",children:"View all"})]}),(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length>0?o.map(n=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[n.type==="deposit"?(0,e.jsx)("div",{className:"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,e.jsx)(ae,{className:"h-4 w-4 text-indigo-600"})}):(0,e.jsx)("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:(0,e.jsx)(me,{className:"h-4 w-4 text-red-600"})}),(0,e.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-900 capitalize",children:n.type})]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.userId||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w(n.amount||0)}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:n.type==="deposit"?(0,e.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Completed"}):(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n.status==="Pending"?"bg-yellow-100 text-yellow-800":n.status==="Accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n.status||"Pending"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t(n.timestamp)})]},n.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No recent activity"})})})]})})]})]})},fs=ps,js=()=>{const{currentUser:i}=J(),[g,U]=(0,s.useState)([]),[v,p]=(0,s.useState)([]),[h,S]=(0,s.useState)(!0),[y,k]=(0,s.useState)(null),[m,x]=(0,s.useState)(""),[T,b]=(0,s.useState)(null),[L,P]=(0,s.useState)(!1),[I,o]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{if(!i)return;const t=q(O(C,"users"),d=>{const n=[];d.forEach(u=>{n.push({id:u.id,...u.data()})}),p(n)},d=>{console.error("Error fetching users:",d)});return()=>t()},[i]),(0,s.useEffect)(()=>{if(!i)return;const t=q(O(C,"loans"),d=>{const n=[];d.forEach(u=>{n.push({id:u.id,...u.data()})}),n.sort((u,a)=>{const c=u.paymentTimestamp?.toDate?.()||new Date(0);return(a.paymentTimestamp?.toDate?.()||new Date(0))-c}),U(n),S(!1)},d=>{console.error("Error fetching paybacks:",d),S(!1)});return()=>t()},[i]);const j=g.map(t=>{const d=v.find(n=>n.uid===t.userId);return{...t,userName:d?.fullName||"Unknown User",userEmail:d?.email||"No email provided"}}),N=(t,d)=>{k({message:t,type:d}),setTimeout(()=>{k(null)},3e3)},E=async t=>{try{o(d=>new Set(d).add(t)),setTimeout(async()=>{const d=Q(C,"loans",t);await X(d,{paymentStatus:"approved",adminReviewedAt:Z()}),setTimeout(()=>{o(n=>{const u=new Set(n);return u.delete(t),u})},300),N("Payment approved successfully!","success")},100)}catch(d){console.error("Error approving payment:",d),N("Failed to approve payment. Please try again.","error"),o(n=>{const u=new Set(n);return u.delete(t),u})}},F=async t=>{try{o(d=>new Set(d).add(t)),setTimeout(async()=>{const d=Q(C,"loans",t);await X(d,{paymentStatus:"denied",adminReviewedAt:Z()}),setTimeout(()=>{o(n=>{const u=new Set(n);return u.delete(t),u})},300),N("Payment denied.","error")},100)}catch(d){console.error("Error denying payment:",d),N("Failed to deny payment. Please try again.","error"),o(n=>{const u=new Set(n);return u.delete(t),u})}},$=t=>{b(t),P(!0)},_=()=>{P(!1),b(null)},z=t=>{if(!t)return"N/A";const d=t.toDate(),n=d.getDate().toString().padStart(2,"0"),u=(d.getMonth()+1).toString().padStart(2,"0"),a=d.getFullYear(),c=d.getHours().toString().padStart(2,"0"),f=d.getMinutes().toString().padStart(2,"0");return`${n}/${u}/${a} ${c}:${f}`},l=j.filter(t=>{if(t.status!=="accepted")return!1;const d=t.userName||"",n=m.toLowerCase();return d.toLowerCase().includes(n)}),w=j.filter(t=>t.status==="accepted"&&t.paymentStatus==="pending").length;return(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[y&&(0,e.jsx)("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 ${y.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:y.message}),(0,e.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Loan Repayment Management"}),(0,e.jsx)("p",{className:"mt-2 text-gray-600",children:"Review and manage loan repayments for accepted loans"})]}),(0,e.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(ee,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by user name...",value:m,onChange:t=>x(t.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})}),(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,e.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Accepted Loan Repayments"}),(0,e.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:[w," pending"]})]}),h?(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4"}),(0,e.jsx)("p",{className:"text-gray-600",children:"Loading loan repayments..."})]}):l.length===0?(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)("div",{className:"mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:(0,e.jsx)(ee,{className:"h-8 w-8 text-gray-400"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No accepted loans found"}),(0,e.jsx)("p",{className:"text-gray-500",children:"There are no accepted loans at the moment."})]}):(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(t=>{const d=I.has(t.id),n=!t.paymentStatus||t.paymentStatus==="pending";return(0,e.jsx)("div",{className:`bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md ${d?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-indigo-800 font-medium",children:t.userName?.charAt(0)?.toUpperCase()||"U"})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:t.userName||"Unknown User"}),(0,e.jsx)("p",{className:"text-sm text-gray-500",children:t.userEmail||"No email provided"})]})]}),(0,e.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                            ${t.paymentStatus==="approved"?"bg-green-100 text-green-800":t.paymentStatus==="denied"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.paymentStatus?.charAt(0)?.toUpperCase()+t.paymentStatus?.slice(1)||"Pending"})]}),(0,e.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Loan Amount"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",t.amount]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Interest (10%)"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",(t.amount*.1).toFixed(2)]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Payable"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",t.totalPayable?.toFixed(2)||(t.amount*1.1).toFixed(2)]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Paid Amount"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",t.paidAmount]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Payment Date"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:z(t.paymentTimestamp)})]}),t.adminReviewedAt&&(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Reviewed At"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:z(t.adminReviewedAt)})]})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proof of Payment"}),t.proofImageUrl?(0,e.jsxs)("div",{className:"relative w-full h-32 rounded-lg overflow-hidden cursor-pointer border border-gray-200",onClick:()=>$(t.proofImageUrl),children:[(0,e.jsx)("img",{src:t.proofImageUrl,alt:"Proof of payment",className:"w-full h-full object-cover"}),(0,e.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:(0,e.jsx)(pe,{className:"h-6 w-6 text-white"})})]}):(0,e.jsx)("div",{className:"w-full h-32 rounded-lg bg-gray-100 flex items-center justify-center border border-gray-200",children:(0,e.jsx)("span",{className:"text-gray-500 text-sm",children:"No proof provided"})})]}),(0,e.jsxs)("div",{className:"flex space-x-3",children:[(0,e.jsxs)("button",{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg transition-colors ${n?"text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>E(t.id),disabled:!n,children:[(0,e.jsx)(Je,{className:"-ml-1 mr-2 h-4 w-4"}),"Approve"]}),(0,e.jsxs)("button",{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border text-sm font-medium rounded-lg transition-colors ${n?"text-gray-700 bg-white border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500":"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed"}`,onClick:()=>F(t.id),disabled:!n,children:[(0,e.jsx)(re,{className:"-ml-1 mr-2 h-4 w-4"}),"Deny"]})]})]})},t.id)})})]})]}),L&&(0,e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:_,children:(0,e.jsxs)("div",{className:"relative max-w-4xl max-h-full",onClick:t=>t.stopPropagation(),children:[(0,e.jsx)("button",{className:"absolute -top-12 right-0 text-white hover:text-gray-300 focus:outline-none",onClick:_,children:(0,e.jsx)(re,{className:"h-8 w-8"})}),(0,e.jsx)("img",{src:T,alt:"Proof of payment",className:"max-w-full max-h-screen rounded-lg"})]})})]})},ys=js,Ns=()=>{const[i,g]=(0,s.useState)([]),[U,v]=(0,s.useState)([]),[p,h]=(0,s.useState)(!0),[S,y]=(0,s.useState)(null),[k,m]=(0,s.useState)(""),[x,T]=(0,s.useState)("All"),[b,L]=(0,s.useState)(null),[P,I]=(0,s.useState)(!1),[o,j]=(0,s.useState)({});(0,s.useEffect)(()=>{const a=W(O(C,"users")),c=q(a,f=>{const R=f.docs.map(M=>({id:M.id,...M.data()}));v(R)},f=>{console.error("Error loading users:",f),y("Failed to load users: "+f.message)});return()=>c()},[]),(0,s.useEffect)(()=>{const a=W(O(C,"deposits"),V("timestamp","desc")),c=q(a,f=>{try{const R=f.docs.map(M=>({id:M.id,...M.data()})).map(M=>{const B=U.find(G=>G.uid===M.userId);return{...M,userName:B?B.fullName||"Unnamed User":"Unknown User"}});g(R),h(!1)}catch(R){console.error("Error merging deposit data:",R),y("Error processing deposit data: "+R.message),h(!1)}},f=>{console.error("Firestore error:",f),y("Failed to load deposits: "+f.message),h(!1)});return()=>c()},[U]);const N=a=>{switch(a){case"accepted":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},E=async(a,c)=>{try{const f=Q(C,"deposits",a);await X(f,{status:c}),console.log(`Deposit ${a} status updated to ${c}`)}catch(f){console.error("Error updating deposit status:",f),y("Failed to update deposit status: "+f.message)}},F=a=>{if(!a)return"N/A";if(a.seconds){const c=new Date(a.seconds*1e3);return c.toLocaleDateString()+" "+c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}if(a.toDate){const c=a.toDate();return c.toLocaleDateString()+" "+c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return a.toString()},$=i.reduce((a,c)=>a+(parseFloat(c.amount)||0),0),_=i.filter(a=>a.status==="pending").length,z=i.filter(a=>a.status==="accepted").length,l=i.filter(a=>a.status==="denied").length,w=i.filter(a=>a.status==="accepted").reduce((a,c)=>a+(parseFloat(c.amount)||0),0),t=i.filter(a=>a.status==="denied").reduce((a,c)=>a+(parseFloat(c.amount)||0),0),d=i.filter(a=>{const c=a.userName?.toLowerCase().includes(k.toLowerCase())||a.userId?.toLowerCase().includes(k.toLowerCase())||a.message?.toLowerCase().includes(k.toLowerCase()),f=x==="All"||a.status===x;return c&&f}),n=a=>{L(a),I(!0)},u=()=>{I(!1),L(null)};return p?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading deposits..."})]})}):S?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",S]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(console.log("DepositsPage: Rendering with deposits array length:",i.length),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Deposits"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",$.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-indigo-100",children:(0,e.jsx)(ae,{className:"h-6 w-6 text-indigo-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:_})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,e.jsx)(De,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Approved Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:z})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)(xe,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Denied Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:l})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(se,{className:"h-6 w-6 text-red-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Accepted Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",w.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)(xe,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Declined Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",t.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(se,{className:"h-6 w-6 text-red-600"})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Deposit Records"}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(ee,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by name, user ID or message...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:k,onChange:a=>m(a.target.value)})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50",value:x,onChange:a=>T(a.target.value),children:[(0,e.jsx)("option",{value:"All",children:"All Statuses"}),(0,e.jsx)("option",{value:"pending",children:"Pending"}),(0,e.jsx)("option",{value:"accepted",children:"Accepted"}),(0,e.jsx)("option",{value:"denied",children:"Denied"})]}),(0,e.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,e.jsx)(ve,{className:"h-5 w-5 text-gray-400"})})]})]})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Name"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proof"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:d.length>0?d.map(a=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.userName}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 italic",children:["ID: ",a.userId]})]}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:["$",a.amount?parseFloat(a.amount).toFixed(2):"0.00"]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${N(a.status||"pending")}`,children:a.status||"pending"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:a.imageUrl?(0,e.jsxs)("button",{onClick:()=>n(a),className:"text-indigo-600 hover:text-indigo-900 flex items-center",children:[(0,e.jsx)(pe,{className:"h-4 w-4 mr-1"}),"View"]}):(0,e.jsx)("span",{className:"text-gray-400",children:"No proof"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F(a.timestamp)}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[a.status==="pending"?(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)("button",{disabled:!!o[a.id],onClick:async()=>{if(window.confirm("Mark this deposit as Accepted?")){j(c=>({...c,[a.id]:!0}));try{await E(a.id,"accepted"),console.log("Deposit accepted:",a.id)}finally{j(c=>{const f={...c};return delete f[a.id],f})}}},className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200 disabled:opacity-50",children:o[a.id]?"Processing...":"Approve"}),(0,e.jsx)("button",{disabled:!!o[a.id],onClick:async()=>{if(window.confirm("Mark this deposit as Denied?")){j(c=>({...c,[a.id]:!0}));try{await E(a.id,"denied"),console.log("Deposit denied:",a.id)}finally{j(c=>{const f={...c};return delete f[a.id],f})}}},className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50",children:o[a.id]?"Processing...":"Deny"})]}):(0,e.jsx)("span",{className:"text-sm text-gray-500",children:a.status||"No actions"}),a.imageUrl?(0,e.jsx)("button",{onClick:()=>window.open(a.imageUrl,"_blank"),className:"text-indigo-600 hover:text-indigo-900 flex items-center",title:"View proof in new tab",children:(0,e.jsx)(we,{className:"h-4 w-4"})}):null]})})]},a.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No deposits found."})})})]})})}),P&&b&&(0,e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,e.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Deposit Proof"}),(0,e.jsx)("button",{onClick:u,className:"text-gray-400 hover:text-gray-500",children:(0,e.jsx)(se,{className:"h-6 w-6"})})]}),(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"User Name"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:b.userName||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"User ID"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:b.userId||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Amount"}),(0,e.jsxs)("p",{className:"text-sm text-gray-900",children:["$",b.amount?parseFloat(b.amount).toFixed(2):"0.00"]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Status"}),(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${N(b.status||"pending")}`,children:b.status||"pending"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Date"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:F(b.timestamp)})]}),(0,e.jsxs)("div",{className:"md:col-span-2",children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Message"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:b.message||"No message"})]})]}),(0,e.jsxs)("div",{className:"mt-6",children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Proof Image"}),(0,e.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:b.imageUrl?(0,e.jsx)("img",{src:b.imageUrl,alt:"Deposit Proof",className:"w-full h-auto max-h-[60vh] object-contain",onError:a=>{a.target.style.display="none"}}):(0,e.jsx)("div",{className:"flex items-center justify-center h-64 bg-gray-100 text-gray-500",children:"No image available"})})]}),(0,e.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,e.jsx)("button",{onClick:u,className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Close"}),b.status==="pending"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("button",{onClick:()=>{E(b.id,"accepted"),u()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700",children:"Approve"}),(0,e.jsx)("button",{onClick:()=>{E(b.id,"denied"),u()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700",children:"Deny"})]})]})]})]})})]}))},bs=Ns;function ws(){const{currentUser:i}=J(),[g,U]=(0,s.useState)([]),[v,p]=(0,s.useState)(""),[h,S]=(0,s.useState)(!0),[y,k]=(0,s.useState)({}),[m,x]=(0,s.useState)({}),T=(0,s.useRef)(),b=(0,s.useRef)(),L=o=>{if(!o)return!1;const j=o.toDate?o.toDate():new Date(o);return(new Date-j)/(1e3*60)<2};(0,s.useEffect)(()=>{if(!i)return;(async()=>{try{const N=Q(C,"users",i.uid);await X(N,{isOnline:!0,lastActive:Z()})}catch(N){console.error("Error setting user online:",N)}})(),b.current=setInterval(async()=>{try{const N=Q(C,"users",i.uid);await X(N,{lastActive:Z()})}catch(N){console.error("Error updating lastActive:",N)}},3e4);const j=async()=>{try{const N=Q(C,"users",i.uid);await X(N,{isOnline:!1,lastActive:Z()})}catch(N){console.error("Error setting user offline:",N)}};return window.addEventListener("beforeunload",j),()=>{clearInterval(b.current),window.removeEventListener("beforeunload",j),i&&(async()=>{try{const E=Q(C,"users",i.uid);await X(E,{isOnline:!1,lastActive:Z()})}catch(E){console.error("Error setting user offline:",E)}})()}},[i]),(0,s.useEffect)(()=>{if(!i){S(!1);return}const o=W(O(C,"messages"),V("timestamp","asc"));return q(o,j=>{U(j.docs.map(N=>({id:N.id,...N.data()}))),S(!1)})},[i]),(0,s.useEffect)(()=>{if(i)return q(O(C,"users"),o=>{const j={},N={};o.forEach(E=>{const F=E.data();j[E.id]=F,L(F.lastActive)&&(N[E.id]={displayName:F.displayName||F.email?.split("@")[0]||"Unknown",isOnline:F.isOnline||!1,lastActive:F.lastActive})}),x(j),k(N)})},[i]);const P=async o=>{if(o.preventDefault(),!(!i||!v.trim()))try{await Ke(O(C,"messages"),{text:v,userId:i.uid,userName:i.email?i.email.split("@")[0]:"Anonymous",timestamp:Z()}),p("")}catch(j){console.error("Error sending message:",j)}};(0,s.useEffect)(()=>{T.current?.scrollIntoView({behavior:"smooth"})},[g]);const I=o=>o?o.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return i?(0,e.jsxs)("div",{className:"flex flex-col w-full h-screen bg-gradient-to-b from-gray-50 to-gray-100 font-sans text-gray-800 max-w-4xl mx-auto w-full",children:[(0,e.jsx)("div",{className:"mx-4 mb-2 bg-white/70 backdrop-blur-md rounded-xl shadow-sm p-3",children:(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,e.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,e.jsxs)("span",{className:"text-xs text-gray-600",children:[Object.keys(y).length," online"]}),(0,e.jsx)("br",{}),(0,e.jsxs)("p",{className:"text-sm text-gray-500",children:[g.length," Messages"]})]})}),(0,e.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-4 max-w-full",children:[h?(0,e.jsx)("div",{className:"flex justify-center p-6",children:(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce"}),(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce",style:{animationDelay:"0.16s"}}),(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce",style:{animationDelay:"0.32s"}})]})}):g.length===0?(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center text-gray-500 p-10 bg-white rounded-2xl shadow-lg m-5",children:[(0,e.jsx)("div",{className:"text-4xl mb-3 opacity-70",children:"ðŸ’¬"}),(0,e.jsx)("div",{className:"text-sm text-center max-w-xs",children:"No messages yet. Start a conversation!"})]}):g.map(o=>(0,e.jsxs)("div",{className:`flex ${o.userId===i.uid?"justify-end":"justify-start"} animate-fade-in`,children:[o.userId!==i.uid&&(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center bg-white text-indigo-600 font-bold flex-shrink-0 shadow-sm mr-2",children:o.userName?o.userName.charAt(0).toUpperCase():"U"}),(0,e.jsx)("div",{className:`absolute bottom-[60px] right-7 w-3.5 h-3.5 rounded-full border-2 border-white ${y[o.userId]?"bg-green-500":"bg-gray-400"}`,title:y[o.userId]?"Online":"Offline"})]}),(0,e.jsxs)("div",{className:`max-w-[72%] p-3 rounded-2xl relative shadow-md transition-all duration-300 hover:shadow-lg ${o.userId===i.uid?"bg-gradient-to-br from-indigo-50 to-indigo-100 border border-indigo-100 rounded-br-md":"bg-white border border-gray-200 rounded-bl-md"}`,children:[(0,e.jsx)("div",{className:"text-sm text-gray-800 leading-relaxed",children:o.text}),(0,e.jsx)("div",{className:"text-xs text-gray-400 text-right mt-2",children:I(o.timestamp)})]}),o.userId===i.uid&&(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold flex-shrink-0 shadow-sm ml-2",children:o.userName?o.userName.charAt(0).toUpperCase():"U"}),(0,e.jsx)("div",{className:`absolute bottom-[60px] right-6 w-3.5 h-3.5 rounded-full border-2 border-white ${L(m[i?.uid]?.lastActive)?"bg-green-500":"bg-gray-400"}`,title:L(m[i?.uid]?.lastActive)?"Online":"Offline"})]})]},o.id)),(0,e.jsx)("div",{ref:T})]}),(0,e.jsxs)("form",{onSubmit:P,className:"flex items-center p-4 gap-3 sticky bottom-0 bg-white/70 backdrop-blur-md border-t border-gray-200",children:[(0,e.jsx)("div",{className:"flex-1 flex items-center bg-white p-2 pl-4 rounded-full shadow-md transition-all duration-300 focus-within:shadow-lg focus-within:border focus-within:border-indigo-500",children:(0,e.jsx)("input",{type:"text",className:"flex-1 border-0 outline-none p-2 bg-transparent text-sm text-gray-800",placeholder:"Type a message...",value:v,onChange:o=>p(o.target.value)})}),(0,e.jsx)("button",{type:"submit",className:"w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white border-none cursor-pointer shadow-md transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:!v.trim(),children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4.5 h-4.5",children:(0,e.jsx)("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})})})]})]}):(0,e.jsx)("div",{className:"flex flex-col h-screen bg-gradient-to-b from-gray-50 to-gray-100 items-center justify-center font-sans text-gray-800",children:(0,e.jsxs)("div",{className:"text-center p-6 bg-white rounded-2xl shadow-lg max-w-md",children:[(0,e.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Please log in to use chat"}),(0,e.jsx)("p",{className:"text-gray-600",children:"You need to be logged in to send and receive messages."})]})})}var vs=()=>(0,e.jsx)("div",{className:"",children:(0,e.jsx)("main",{children:(0,e.jsx)(ws,{})})}),Ss=vs,Ds=()=>{const[i,g]=(0,s.useState)(!1),{currentUser:U}=J(),v=Te(),p=he(),{logout:h}=J(),S=async()=>{try{await h(),p("/login")}catch(m){console.error("Failed to log out",m)}};(0,s.useEffect)(()=>{const m=()=>{window.innerWidth>=1024&&g(!1)};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),(0,s.useEffect)(()=>{const m=x=>{i&&!x.target.closest(".sidebar-content")&&!x.target.closest(".sidebar-toggle")&&g(!1)};return document.addEventListener("click",m),()=>document.removeEventListener("click",m)},[i]),(0,s.useEffect)(()=>{g(!1)},[v.pathname]);const y=[{name:"Dashboard",href:"/dashboard",icon:ts},{name:"Deposits",href:"/deposits",icon:ds},{name:"loans",href:"/loans",icon:as},{name:"Chat",href:"/chat",icon:ss},{name:"Users",href:"/users",icon:Se},{name:"Payback",href:"/payback",icon:Ze},{name:"Settings",href:"/settings",icon:es}],k=m=>v.pathname===m;return(0,e.jsxs)("div",{className:"flex h-screen w-screen max-w-full bg-gray-50",children:[(0,e.jsx)("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform ${i?"translate-x-0":"-translate-x-full"} transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 sidebar-content`,children:(0,e.jsxs)("div",{className:"flex flex-col h-full",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-white font-bold",children:"MB"})})}),(0,e.jsx)("div",{className:"ml-3",children:(0,e.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"MoneyBox"})})]}),(0,e.jsx)("button",{onClick:()=>g(!1),className:"lg:hidden text-gray-500 hover:text-gray-700",children:(0,e.jsx)(re,{size:20})})]}),(0,e.jsx)("nav",{className:"flex-1 px-4 py-6 overflow-y-auto",children:(0,e.jsx)("ul",{className:"space-y-1",children:y.map(m=>(0,e.jsx)("li",{children:(0,e.jsxs)(ge,{to:m.href,className:`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 ${k(m.href)?"bg-indigo-50 text-indigo-700":"text-gray-700 hover:bg-gray-100"}`,children:[(0,e.jsx)(m.icon,{className:"mr-3 h-5 w-5"}),m.name]})},m.name))})}),(0,e.jsxs)("div",{className:"px-4 py-6 border-t border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,e.jsx)("div",{className:"w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold shadow-md",children:U?.email?.charAt(0).toUpperCase()||"U"})})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Admin  is           ",U?.email?.slice(0,5).toUpperCase()||"U"]}),(0,e.jsx)("p",{className:"text-xs text-gray-500",children:U?.email?.slice(0,104).toLowerCase()||"U"})]})]}),(0,e.jsxs)("button",{onClick:S,className:"flex items-center w-full px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[(0,e.jsx)(je,{className:"mr-3 h-5 w-5"}),"Logout"]})]})]})}),(0,e.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,e.jsx)("header",{className:"bg-white shadow-sm z-10",children:(0,e.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("button",{onClick:()=>g(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 mr-4 sidebar-toggle",children:(0,e.jsx)(ns,{size:20})}),(0,e.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[v.pathname==="/dashboard"&&"ðŸ’° Dashboard",v.pathname==="/deposits"&&"ðŸ’° Deposits Overview",v.pathname==="/loans"&&"ðŸ’¸ loans Overview",v.pathname==="/users"&&"ðŸ‘¥ Users Overview",v.pathname==="/chat"&&"ðŸ‘¥ Users Overview"]})]}),(0,e.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(ee,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search...",className:"block w-64 pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,e.jsxs)("button",{className:"p-1 text-gray-500 hover:text-gray-700 relative",children:[(0,e.jsx)(Qe,{className:"h-6 w-6"}),(0,e.jsx)("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]}),(0,e.jsx)("div",{className:"flex items-center",children:(0,e.jsx)("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,e.jsx)(rs,{className:"h-5 w-5 text-indigo-600"})})}),(0,e.jsxs)("button",{onClick:S,className:"flex items-center text-sm font-medium text-gray-700 hover:text-gray-900",children:[(0,e.jsx)(je,{className:"mr-2 h-5 w-5"}),"Logout"]})]})]})}),(0,e.jsx)("main",{className:"flex-1 overflow-y-auto bg-gray-50 p-6",children:(0,e.jsx)("div",{className:"h-full w-full",children:(0,e.jsx)(Pe,{})})})]})]})},Ce=Ds,As=()=>(0,e.jsx)(Ce,{children:(0,e.jsxs)("div",{className:"py-10",children:[(0,e.jsx)("header",{children:(0,e.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,e.jsx)("h1",{className:"text-3xl font-bold leading-tight text-gray-900",children:"Money Box Admin Portal"})})}),(0,e.jsx)("main",{children:(0,e.jsx)("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:(0,e.jsx)("div",{className:"px-4 py-8 sm:px-0",children:(0,e.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,e.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,e.jsx)("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"Welcome to the Admin Portal"}),(0,e.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Use the navigation menu to access different sections"})]}),(0,e.jsx)("div",{className:"border-t border-gray-200",children:(0,e.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,e.jsx)("p",{className:"text-gray-600",children:"You are successfully logged in. Use the sidebar navigation to access different parts of the admin portal."})})})]})})})})]})}),ks=As,Cs=()=>{const[i,g]=(0,s.useState)([]),[U,v]=(0,s.useState)([]),[p,h]=(0,s.useState)(!0),[S,y]=(0,s.useState)(null),[k,m]=(0,s.useState)(""),[x,T]=(0,s.useState)("All"),[b,L]=(0,s.useState)({});(0,s.useEffect)(()=>{const l=W(O(C,"users")),w=q(l,t=>{const d=t.docs.map(n=>({id:n.id,...n.data()}));v(d)},t=>{console.error("Error loading users:",t),y("Failed to load users: "+t.message)});return()=>w()},[]),(0,s.useEffect)(()=>{const l=W(O(C,"loans"),V("timestamp","desc")),w=q(l,t=>{try{const d=t.docs.map(n=>({id:n.id,...n.data()})).map(n=>{const u=U.find(a=>a.uid===n.userId);return{...n,userName:u?u.fullName||"Unnamed User":"Unknown User"}});g(d),h(!1)}catch(d){console.error("Error merging loan data:",d),y("Error processing loan data: "+d.message),h(!1)}},t=>{console.error("Firestore error:",t),y("Failed to load loans: "+t.message),h(!1)});return()=>w()},[U]);const P=l=>{switch(l){case"accepted":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"Pending":case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},I=async(l,w)=>{try{const t=Q(C,"loans",l);await X(t,{status:w}),console.log(`Loan ${l} status updated to ${w}`)}catch(t){console.error("Error updating loan status:",t),y("Failed to update loan status: "+t.message)}},o=l=>{if(!l)return"N/A";if(l.seconds){const w=new Date(l.seconds*1e3);return w.toLocaleDateString()+" "+w.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}if(l.toDate){const w=l.toDate();return w.toLocaleDateString()+" "+w.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return l.toString()},j=i.reduce((l,w)=>l+(parseFloat(w.amount)||0),0),N=i.filter(l=>l.status==="pending").length,E=i.filter(l=>l.status==="accepted").length,F=i.filter(l=>l.status==="denied").length,$=i.filter(l=>l.status==="accepted").reduce((l,w)=>l+(parseFloat(w.amount)||0),0),_=i.filter(l=>l.status==="denied").reduce((l,w)=>l+(parseFloat(w.amount)||0),0),z=i.filter(l=>{const w=l.userName?.toLowerCase().includes(k.toLowerCase())||l.userId?.toLowerCase().includes(k.toLowerCase())||l.message?.toLowerCase().includes(k.toLowerCase()),t=x==="All"||l.status===x;return w&&t});return p?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading loans..."})]})}):S?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",S]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total loans"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",j.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-blue-100",children:(0,e.jsx)(me,{className:"h-6 w-6 text-blue-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:N})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,e.jsx)(De,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Paid loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:E})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)(os,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Declined loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:F})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(se,{className:"h-6 w-6 text-red-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Accepted Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",$.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)(xe,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Declined Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",_.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(se,{className:"h-6 w-6 text-red-600"})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Loans Records"}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(ee,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by name, user ID or message...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:k,onChange:l=>m(l.target.value)})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50",value:x,onChange:l=>T(l.target.value),children:[(0,e.jsx)("option",{value:"All",children:"All Statuses"}),(0,e.jsx)("option",{value:"Pending",children:"Pending"}),(0,e.jsx)("option",{value:"accepted",children:"Paid"}),(0,e.jsx)("option",{value:"denied",children:"Declined"})]}),(0,e.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,e.jsx)(ve,{className:"h-5 w-5 text-gray-400"})})]})]})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Name"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:z.length>0?z.map(l=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,e.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:l.userName}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 italic",children:["ID: ",l.userId]})]}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:["$",l.amount?parseFloat(l.amount).toFixed(2):"0.00"]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${P(l.status)}`,children:l.status==="accepted"?"Paid":l.status||"Pending"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o(l.timestamp)}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[l.status==="pending"?(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)("button",{disabled:!!b[l.id],onClick:async()=>{if(window.confirm("Mark this loan as Paid?")){L(w=>({...w,[l.id]:!0}));try{await I(l.id,"accepted")}finally{L(w=>{const t={...w};return delete t[l.id],t})}}},className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200 disabled:opacity-50",children:b[l.id]?"Processing...":"Pay"}),(0,e.jsx)("button",{disabled:!!b[l.id],onClick:async()=>{if(window.confirm("Mark this loan as Declined?")){L(w=>({...w,[l.id]:!0}));try{await I(l.id,"denied")}finally{L(w=>{const t={...w};return delete t[l.id],t})}}},className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50",children:b[l.id]?"Processing...":"Decline"})]}):(0,e.jsx)("span",{className:"text-sm text-gray-500",children:l.status==="accepted"?"Paid":l.status}),l.imageUrl&&(0,e.jsx)("button",{onClick:()=>window.open(l.imageUrl,"_blank"),className:"text-indigo-600 hover:text-indigo-900 flex items-center",title:"View proof",children:(0,e.jsx)(ls,{className:"h-4 w-4"})})]})})]},l.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No loans found."})})})]})})})]})},Us=Cs,Es=()=>{const[i,g]=(0,s.useState)([]),[U,v]=(0,s.useState)(!0),[p,h]=(0,s.useState)(null),[S,y]=(0,s.useState)(""),[k,m]=(0,s.useState)(!1),[x,T]=(0,s.useState)(null),[b,L]=(0,s.useState)([]),[P,I]=(0,s.useState)([]),[o,j]=(0,s.useState)(!1),[N,E]=(0,s.useState)(!1),[F,$]=(0,s.useState)(null),[_,z]=(0,s.useState)(null),[l,w]=(0,s.useState)({}),t=(0,s.useRef)(null),d=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!C){h("Firestore instance not available"),v(!1);return}const r=W(O(C,"users"),V("createdAt","desc")),D=q(r,A=>{try{const Y=A.docs.map(H=>({id:H.id,...H.data()}));g(Y),v(!1)}catch(Y){console.error("Error processing users snapshot:",Y),h("Failed to process users data"),v(!1)}},A=>{console.error("Error fetching users:",A),A.code==="permission-denied"?h("Permission denied. Check Firestore rules."):h("Failed to load users: "+(A.message||"Unknown error")),v(!1)});return()=>D()},[]),(0,s.useEffect)(()=>{if(t.current&&(t.current(),t.current=null),d.current&&(d.current(),d.current=null),!x){L([]),I([]);return}j(!0),$(null);const r=W(O(C,"deposits"),V("timestamp","desc"));t.current=q(r,A=>{try{const Y=A.docs.map(H=>({id:H.id,...H.data()})).filter(H=>H.userId===x.uid);L(Y),j(!1)}catch(Y){console.error("Error processing deposits snapshot:",Y),$("Failed to process deposits data"),j(!1)}},A=>{console.error("Error fetching deposits:",A),$("Failed to load deposits: "+(A.message||"Unknown error")),j(!1)}),E(!0),z(null);const D=W(O(C,"loans"),V("timestamp","desc"));return d.current=q(D,A=>{try{const Y=A.docs.map(H=>({id:H.id,...H.data()})).filter(H=>H.userId===x.uid);I(Y),E(!1)}catch(Y){console.error("Error processing loans snapshot:",Y),z("Failed to process loans data"),E(!1)}},A=>{console.error("Error fetching loans:",A),z("Failed to load loans: "+(A.message||"Unknown error")),E(!1)}),()=>{t.current&&(t.current(),t.current=null),d.current&&(d.current(),d.current=null)}},[x]);const n=r=>{if(!r)return"N/A";if(r.seconds)return new Date(r.seconds*1e3).toLocaleString();if(r.toDate)return r.toDate().toLocaleString();try{return new Date(r).toLocaleString()}catch{return String(r)}},u=r=>{switch(r?.toLowerCase()){case"accepted":return"bg-green-100 text-green-800";case"denied":case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},a=r=>{T(r),m(!0)},c=()=>{m(!1)},f=r=>{window.open(r,"_blank")},R=(r,D)=>{const A=document.createElement("a");A.href=r,A.download=D||"proof-image.jpg",document.body.appendChild(A),A.click(),document.body.removeChild(A)},M=b.reduce((r,D)=>r+(D.amount||0),0),B=P.reduce((r,D)=>r+(D.amount||0),0);b.filter(r=>r.status==="pending").length,b.filter(r=>r.status==="accepted").length,b.filter(r=>r.status==="denied"||r.status==="rejected").length,P.filter(r=>r.status==="pending").length,P.filter(r=>r.status==="accepted").length,P.filter(r=>r.status==="denied"||r.status==="rejected").length;const G=i.filter(r=>{const D=S.trim().toLowerCase();return D?(r.fullName||"").toLowerCase().includes(D)||(r.email||"").toLowerCase().includes(D)||(r.phoneNumber||"").toLowerCase().includes(D)||(r.uid||"").toLowerCase().includes(D):!0});return U?(0,e.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]})}):p?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",p]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 md:col-span-1",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:i.length})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a4 4 0 00-4-4h-1M9 20H4v-2a4 4 0 014-4h1m0-4a4 4 0 100-8 4 4 0 000 8z"})})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 md:col-span-3",children:(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"User Records"}),(0,e.jsx)("div",{className:"flex items-center w-full sm:w-64",children:(0,e.jsxs)("div",{className:"relative w-full",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(ee,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search users...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:S,onChange:r=>y(r.target.value)})]})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gender"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:G.length>0?G.map(r=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150 cursor-pointer",onClick:()=>a(r),children:[(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[r.imageUrl?(0,e.jsx)("img",{src:r.imageUrl,alt:r.fullName||"avatar",className:"h-10 w-10 rounded-full object-cover",onError:D=>{D.target.style.display="none"}}):(0,e.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-medium text-gray-700",children:(r.fullName||"U").split(" ").map(D=>D[0]).slice(0,2).join("").toUpperCase()}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:r.fullName||"No name"}),(0,e.jsx)("div",{className:"text-xs text-gray-500",children:r.uid||""})]})]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.email||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.phoneNumber||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:r.gender||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.age||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n(r.createdAt)})]},r.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No users found."})})})]})})}),k&&x&&(0,e.jsx)("div",{className:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-auto",children:[(0,e.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["User Details: ",x.fullName]}),(0,e.jsx)("button",{onClick:c,className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:(0,e.jsx)(re,{className:"h-5 w-5 text-gray-500"})})]}),(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[x.imageUrl?(0,e.jsx)("img",{src:x.imageUrl,alt:x.fullName||"avatar",className:"h-16 w-16 rounded-full object-cover mr-4"}):(0,e.jsx)("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center text-xl font-medium text-gray-700 mr-4",children:(x.fullName||"U").split(" ").map(r=>r[0]).slice(0,2).join("").toUpperCase()}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:x.fullName||"No name"}),(0,e.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",x.uid||"N/A"]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:x.email||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Phone Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:x.phoneNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"MoMo Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:x.momoNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Credit card Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:x.creditCardNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Gender"}),(0,e.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:x.gender||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Age"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:x.age||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Joined Date"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:n(x.createdAt)})]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,e.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"p-2 rounded-full bg-green-100 mr-3",children:(0,e.jsx)(ae,{className:"h-6 w-6 text-green-600"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Deposits Summary"})]}),(0,e.jsx)("div",{className:"space-y-3",children:(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Amount:"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",M.toFixed(2)]})]})})]}),(0,e.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"p-2 rounded-full bg-blue-100 mr-3",children:(0,e.jsx)(is,{className:"h-6 w-6 text-blue-600"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Loans Summary"})]}),(0,e.jsx)("div",{className:"space-y-3",children:(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Amount:"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",B.toFixed(2)]})]})})]})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Deposits"}),o?(0,e.jsx)("div",{className:"flex justify-center py-4",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):F?(0,e.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,e.jsx)("p",{className:"text-sm text-red-800",children:F})}):b.length>0?(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proof"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(r=>(0,e.jsxs)("tr",{children:[(0,e.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:["$",r.amount||"0"]}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${u(r.status)}`,children:r.status||"Unknown"})}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:n(r.timestamp)}),(0,e.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:r.message,children:r.message||"N/A"}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:r.proofImage?(0,e.jsxs)("div",{className:"flex space-x-2",children:[(0,e.jsx)("button",{onClick:()=>f(r.proofImage),className:"text-indigo-600 hover:text-indigo-900",title:"View",children:(0,e.jsx)(pe,{className:"h-5 w-5"})}),(0,e.jsx)("button",{onClick:()=>R(r.proofImage,`deposit-proof-${r.id}.jpg`),className:"text-indigo-600 hover:text-indigo-900",title:"Download",children:(0,e.jsx)(we,{className:"h-5 w-5"})})]}):"N/A"})]},r.id))})]})}):(0,e.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No deposits found."})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Loans"}),N?(0,e.jsx)("div",{className:"flex justify-center py-4",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):_?(0,e.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,e.jsx)("p",{className:"text-sm text-red-800",children:_})}):P.length>0?(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reason"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved By"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(r=>(0,e.jsxs)("tr",{children:[(0,e.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:["$",r.amount||"0"]}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${u(r.status)}`,children:r.status||"Unknown"})}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:n(r.timestamp)}),(0,e.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:r.reason,children:r.reason||"N/A"}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:r.approvedBy||"N/A"})]},r.id))})]})}):(0,e.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No loans found."})]})]})]})})]})},Ls=Es,Ps=()=>{const[i,g]=(0,s.useState)("10.00"),[U,v]=(0,s.useState)(!0),[p,h]=(0,s.useState)(!1),[S,y]=(0,s.useState)(null),[k,m]=(0,s.useState)("success"),[x,T]=(0,s.useState)([]),[b,L]=(0,s.useState)(!1),[P,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{const N=W(O(C,"interest"),V("timestamp","desc"),qe(10)),E=await ze(N);if(E.empty)g("10.00");else{const F=E.docs[0];g(F.data().interest.toFixed(2)),I(F.id);const $=E.docs.map(_=>({date:new Date(_.data().timestamp?.toDate()||Date.now()).toLocaleDateString(),rate:parseFloat(_.data().interest)})).reverse();T($)}}catch(N){console.error("Error fetching interest:",N),y("Failed to load interest rate"),m("error"),setTimeout(()=>y(null),3e3)}finally{v(!1)}})()},[]);const o=async()=>{if(isNaN(i)||i<1||i>100){y("Please enter a valid interest rate between 1% and 100%"),m("error"),setTimeout(()=>y(null),3e3);return}h(!0);try{const j=new Date;if(P){const N=Q(C,"interest",P);await X(N,{interest:Number(i),timestamp:j})}else await $e(Q(C,"interest","globalRate"),{interest:Number(i),timestamp:j}),I("globalRate");y("Interest rate updated successfully!"),m("success"),T(N=>[...N.slice(-9),{date:j.toLocaleDateString(),rate:Number(i)}])}catch(j){console.error("Error updating interest:",j),y("Failed to update interest rate"),m("error")}finally{h(!1),setTimeout(()=>y(null),3e3)}};return U?(0,e.jsx)("div",{className:"flex justify-center items-center min-h-screen px-4",children:(0,e.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full max-w-md text-center",children:[(0,e.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Loading interest rate..."})]})}):(0,e.jsxs)("div",{className:"flex justify-center items-center min-h-screen px-4 bg-gray-50 dark:bg-gray-900",children:[(0,e.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-4 sm:p-6 md:p-10 w-full max-w-md",children:[(0,e.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6 text-center",children:"Interest Rate Settings"}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:"Current Interest Rate (%)"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("input",{type:"number",step:"0.01",min:"1",max:"100",value:i,onChange:j=>g(j.target.value),className:"border border-gray-300 dark:border-gray-700 rounded-lg p-3 w-full focus:ring-2 focus:ring-blue-500 outline-none pr-12",disabled:p,placeholder:"Enter interest rate (1â€“100)"}),(0,e.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"%"})]}),(0,e.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter as a percentage (e.g., 5 for 5%)"})]}),(0,e.jsx)("button",{onClick:o,disabled:p,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 w-full disabled:opacity-50 flex items-center justify-center text-sm sm:text-base",children:p?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"}),(0,e.jsx)("div",{className:"mt-6 text-center",children:(0,e.jsxs)("button",{onClick:()=>L(!b),className:"text-blue-600 dark:text-blue-400 text-sm font-medium hover:underline",children:[b?"Hide":"Show"," Rate History"]})}),b&&x.length>0&&(0,e.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Interest Rate History"}),(0,e.jsx)("div",{className:"h-48",children:(0,e.jsx)(de,{width:"100%",height:"100%",children:(0,e.jsxs)(Ne,{data:x,children:[(0,e.jsx)(oe,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),(0,e.jsx)(le,{dataKey:"date",tick:{fontSize:12}}),(0,e.jsx)(ce,{tick:{fontSize:12},domain:["dataMin - 0.5","dataMax + 0.5"]}),(0,e.jsx)(ie,{formatter:j=>`${j.toFixed(2)}%`,contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px"}}),(0,e.jsx)(ne,{type:"monotone",dataKey:"rate",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})]})]}),S&&(0,e.jsx)("div",{className:`fixed top-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg text-white font-semibold shadow-md transition-all duration-300 ${k==="success"?"bg-green-500":"bg-red-500"}`,children:S})]})},Fs=Ps;function Ts({children:i}){const{currentUser:g}=J();return g?i:(0,e.jsx)(be,{to:"/login"})}function ye({children:i}){const{currentUser:g}=J();return g?(0,e.jsx)(be,{to:"/dashboard"}):i}function Is(){return(0,e.jsxs)(Fe,{children:[(0,e.jsx)(K,{path:"/login",element:(0,e.jsx)(ye,{children:(0,e.jsx)(xs,{})})}),(0,e.jsx)(K,{path:"/signup",element:(0,e.jsx)(ye,{children:(0,e.jsx)(us,{})})}),(0,e.jsxs)(K,{path:"/",element:(0,e.jsx)(Ts,{children:(0,e.jsx)(Ce,{})}),children:[(0,e.jsx)(K,{index:!0,element:(0,e.jsx)(ks,{})}),(0,e.jsx)(K,{path:"profile",element:(0,e.jsx)(gs,{})}),(0,e.jsx)(K,{path:"dashboard",element:(0,e.jsx)(fs,{})}),(0,e.jsx)(K,{path:"deposits",element:(0,e.jsx)(bs,{})}),(0,e.jsx)(K,{path:"loans",element:(0,e.jsx)(Us,{})}),(0,e.jsx)(K,{path:"payback",element:(0,e.jsx)(ys,{})}),(0,e.jsx)(K,{path:"users",element:(0,e.jsx)(Ls,{})}),(0,e.jsx)(K,{path:"settings",element:(0,e.jsx)(Fs,{})}),(0,e.jsx)(K,{path:"chat",element:(0,e.jsx)(Ss,{})})]})]})}var Rs=Is;(0,cs.createRoot)(document.getElementById("root")).render((0,e.jsx)(s.StrictMode,{children:(0,e.jsx)(ms,{children:(0,e.jsx)(Ie,{children:(0,e.jsx)(Rs,{})})})}));
